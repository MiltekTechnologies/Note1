<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Gokul MC">
<title>Summary of work done @ BluGraph</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
<h1><span class="Red">Summary of work done</span> @ <strong class="aqua">BluGraph</strong></h1>
<div class="details">
<span id="author" class="author">Gokul MC</span><br>
<span id="email" class="email"><a href="mailto:mcgokul123@gmail.com">mcgokul123@gmail.com</a></span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">April 10, 2020, BluGraph Technologies</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_gstreamer_cctv_streaming"><strong>Gstreamer - CCTV streaming</strong></a>
<ul class="sectlevel2">
<li><a href="#_problem_statement">Problem Statement</a></li>
<li><a href="#_introduction_to_gstreamer">Introduction to Gstreamer</a></li>
<li><a href="#_push_cctv_stream_to_cloud_using_gstreamer"><em>Push CCTV stream to cloud using Gstreamer</em></a></li>
<li><a href="#_h265_through_aws_kinesis">h265 through AWS Kinesis</a></li>
</ul>
</li>
<li><a href="#_microk8s_with_2_rpis"><strong>MicroK8s with 2 RPis</strong></a>
<ul class="sectlevel2">
<li><a href="#_microk8s">MicroK8s</a></li>
</ul>
</li>
<li><a href="#_other_development_tool"><strong>Other development tool</strong></a>
<ul class="sectlevel2">
<li><a href="#_ffmpeg">ffmpeg</a></li>
<li><a href="#_docker">Docker</a></li>
<li><a href="#_kubernetes">Kubernetes</a></li>
<li><a href="#_openshift">Openshift</a></li>
<li><a href="#_bigpipe">Bigpipe</a></li>
<li><a href="#_amp">AMP</a></li>
<li><a href="#_buddy_kubernetes_automated_deployment">Buddy - Kubernetes Automated Deployment</a></li>
<li><a href="#_ipmac_based_networking">IP/Mac based networking</a></li>
<li><a href="#_telnet">Telnet</a></li>
<li><a href="#_nmap">Nmap</a></li>
<li><a href="#_graphana">Graphana</a></li>
<li><a href="#_git">git</a></li>
<li><a href="#_regex">Regex</a></li>
<li><a href="#_http23">HTTP2/3</a></li>
<li><a href="#_what_is_http">What is HTTP ?</a></li>
<li><a href="#_rest_api">REST API</a></li>
<li><a href="#_why_http_2">Why HTTP 2</a></li>
<li><a href="#_why_http_3_what_is_it">Why HTTP 3 &amp; what is it</a></li>
<li><a href="#_raspberry_pi_based_image_capture">Raspberry pi based image capture</a></li>
<li><a href="#_gitlab_host_on_server">Gitlab host on Server</a></li>
<li><a href="#_combining_to_book">Combining to Book</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document is summary of the work done and in progress as part of the internship at Blugraph technologies.
The author attempts to explain in detail the various projects attempted and their progress there off.
This document also covers various technologies that were tried out as part of the ongoing internship.
The aim of this document is to ensure a head-start for repeating the same or a similar project in future.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gstreamer_cctv_streaming"><strong>Gstreamer - CCTV streaming</strong></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_problem_statement">Problem Statement</h3>
<div class="paragraph">
<p>To understand the technological know how of the project, we need to be clear on the need for such a system.
CCTVs are everywhere, they are used for various purposes. A lot of applications are developed
to enhance or extend the use of CCTV cameras. That is by using the stream for Video analytics,
Computer vision etc. Video is different from Images as the individual frames act like images but the entire stream
is our interest. Codecs are developed for streams of the frames, not the individial frames. The most famous h264 codec
kind of finds the difference between the frames and transmits the difference, hence saving time and space. Thats why in some codes
we find the contours disturbed but stable textures. h265 is faster but has its own compatibility issues.</p>
</div>
<div class="paragraph">
<p>Let us start with a simple application of ANPR, where the frames need to be available in cloud instance (EC2) for us to
detect the number plates. To get the stream we need to somehow connect these two.</p>
</div>
<div class="olist arabic">
<div class="title">Problems</div>
<ol class="arabic">
<li>
<p>CCTVs are connected in a LAN network</p>
</li>
<li>
<p>The IP address of the Cameras are not static</p>
</li>
<li>
<p>The Singtel network is just a bigger LAN network - with Dynamic IP for security</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now the problem becomes more complicated and flavourful</p>
</div>
<div class="olist arabic">
<div class="title">Solutions</div>
<ol class="arabic">
<li>
<p>Use a port forwarding for individual CCTVs and fix the IP allocation in the router/switch - <em>Even thought this
seems like a plausible solution, because the public IP address of the router(3G modem connected to the LAN or the router itself) is not actually public</em></p>
</li>
<li>
<p>Send the Public IP address of the device continuously. <em>This seems like plausible solution, but it is not as we donot have the ip address of the the Singtel network or can&#8217;t port forward to access the individual modems or devices publicly</em></p>
</li>
<li>
<p><strong>Soln</strong> Send the stream from CCTC RTSP server to another cloud based RTSP server. 1st RTSP server inside the camera is a source, whereas 2nd is a rtspsinkclient [push]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This can be implemented on a RPi or Nano in the same network as the CCTVs and all the CCTV streams can be streamed through different streams of a RTSP server located at
the cloud. Initially we use the Wowza cloud streaming platform for testing[chargeable] and then create our own instance of a RTSP server in a digital oceon/EC2 cloud.</p>
</div>
</div>
<div class="sect2">
<h3 id="_introduction_to_gstreamer">Introduction to Gstreamer</h3>
<div class="paragraph">
<p>GStreamer is a pipeline-based multimedia framework that links together a wide variety of media processing systems to complete complex workflows. For instance, GStreamer can be used to build a system that reads files in one format, processes them, and exports them in another. The formats and processes can be changed in a plug and play fashion.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-1f22a.png" alt="A set of pipelines connected control the media stream">
</div>
<div class="title">Figure 1. Gstreamer pipeline example</div>
</div>
<div class="paragraph">
<p>GStreamer processes media by connecting a number of processing elements into a pipeline. Each element is provided by a plug-in. Elements can be grouped into bins, which can be further aggregated, thus forming a hierarchical graph. This is an example of a filter graph.</p>
</div>
<div class="paragraph">
<p>Elements communicate by means of pads. A source pad on one element can be connected to a sink pad on another. When the pipeline is in the playing state, data buffers flow from the source pad to the sink pad. Pads negotiate the kind of data that will be sent using capabilities.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-d1dd9.png" alt="bg d1dd9">
</div>
<div class="title">Figure 2. Elements communicate using pads, the sink and source pads need to match for link</div>
</div>
<div class="sect3">
<h4 id="_plugins">Plugins</h4>
<div class="paragraph">
<p>GStreamer uses a plug-in architecture which makes the most of GStreamer&#8217;s functionality implemented as shared libraries. GStreamer&#8217;s base functionality contains functions for registering and loading plug-ins and for providing the fundamentals of all classes in the form of base classes. Plug-in libraries get dynamically loaded to support a wide spectrum of codecs, container formats, input/output drivers and effects.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Gstreamer Plugins</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Set name</th>
<th class="tableblock halign-left valign-top">Desr.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default set of plugins that come as part of the package - registering and loading plug-ins and for providing the fundamentals of all classes in the form of base classes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Good</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This package contains the GStreamer plug-ins from the "good" set, a set of high quality plug-ins under the LGPL license</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GStreamer Bad Plug-ins comprises a set of plug-ins not up-to-par compared to the rest. They might closely approach good-quality plug-ins, but they lack something: perhaps a good code review, some documentation, a set of tests, a real live maintainer, or some actual wide use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ugly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This package contains plug-ins from the "ugly" set, a set of good-quality plug-ins that might pose distribution problems.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://gstreamer.freedesktop.org/documentation/plugins_doc.html" class="bare">https://gstreamer.freedesktop.org/documentation/plugins_doc.html</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-5e1a9.png" alt="bg 5e1a9">
</div>
</div>
<div class="paragraph">
<p>There are 250+ plugins in Gstreamer. Since the framework itself has been there for a while, there is a abundance of
of plugins. We can even write our own custom plugins</p>
</div>
</div>
<div class="sect3">
<h4 id="_history">History</h4>
<div class="paragraph">
<p>The development started way back in 1999 at Oregon Graduate Institute. The first major release
0.1.0 was released in 2001. Currently we have a 1.0 version which is widely used.</p>
</div>
<div class="paragraph">
<p>There&#8217;s also a separate GStreamer FFmpeg plug-in, which is a FFmpeg-based plug-in that supports many additional media formats. It was first released on 26 February 2004.</p>
</div>
<div class="paragraph">
<p>Gstreamer is written in c and bindings for javascript and python are also available. Most of the functions/pipelines
can be directly constructed using CLI using gst-launch1.0 function. We will discuss in detail in later section but for a simple
introduction the following code streams the webcam stream on the screen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 avfvideosrc capture-screen=true ! autovideosink</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_push_cctv_stream_to_cloud_using_gstreamer"><em>Push CCTV stream to cloud using Gstreamer</em></h3>
<div class="sect3">
<h4 id="_understanding_rtsp">Understanding RTSP</h4>
<div class="paragraph">
<p>The Real Time Streaming Protocol (RTSP) is a network control protocol designed for use in entertainment and communications systems to control streaming media servers. The protocol is used for establishing and controlling media sessions between end points. Clients of media servers issue VHS-style commands, such as play, record and pause, to facilitate real-time control of the media streaming from the server to a client (Video On Demand) or from a client to the server (Voice Recording).</p>
</div>
<div class="paragraph">
<p>RTSP = RTP + Play|Pause feature</p>
</div>
<div class="paragraph">
<p>The transmission of streaming data itself is not a task of RTSP. Most RTSP servers use the Real-time Transport Protocol (RTP) in conjunction with Real-time Control Protocol (RTCP) for media stream delivery. However, some vendors implement proprietary transport protocols. The RTSP server software from RealNetworks, for example, also used RealNetworks' proprietary Real Data Transport (RDT).</p>
</div>
<div class="paragraph">
<p>While similar in some ways to HTTP, RTSP defines control sequences useful in controlling multimedia playback. While HTTP is stateless, RTSP has state; an identifier is used when needed to track concurrent sessions. Like HTTP, RTSP uses TCP to maintain an end-to-end connection and, while most RTSP control messages are sent by the client to the server, some commands travel in the other direction (i.e. from server to client).</p>
</div>
<div class="paragraph">
<p>A state is the information about client or the transmission usually stored in the server, this increases the extra storage needed for storing the information of the session.</p>
</div>
<div class="paragraph">
<p>HTTP Live Streaming (also known as HLS) is an HTTP-based adaptive bitrate streaming communications protocol developed by Apple Inc. and released in 2009. Support for the protocol is widespread in media players, web browsers, mobile devices, and streaming media servers. An annual video industry survey has consistently found it to be the most popular streaming format.[2]</p>
</div>
<div class="paragraph">
<p>HLS resembles MPEG-DASH in that it works by breaking the overall stream into a sequence of small HTTP-based file downloads, each download loading one short chunk of an overall potentially unbounded transport stream. A list of available streams, encoded at different bit rates, is sent to the client using an extended M3U playlist.[3]</p>
</div>
<div class="paragraph">
<p>Based on standard HTTP transactions, HTTP Live Streaming can traverse any firewall or proxy server that lets through standard HTTP traffic, unlike UDP-based protocols such as RTP. This also allows content to be offered from conventional HTTP servers and delivered over widely available HTTP-based content delivery networks.[4] The standard also includes a standard encryption mechanism[5] and secure-key distribution using HTTPS, which together provide a simple DRM system. Later versions of the protocol also provide for trick-mode fast-forward and rewind and for integration of subtitles.</p>
</div>
<div class="paragraph">
<p>BTW <strong>Youtube</strong> uses RTSP streaming protocol for all its video on demands.
It uses HLS for <a href="https://developers.google.com/youtube/v3/live/guides/hls-ingestion">Livestream</a></p>
</div>
<div class="paragraph">
<p>WebRTC (Web Real-Time Communication) is a free, open-source project that provides web browsers and mobile applications with real-time communication (RTC) via simple application programming interfaces (APIs). It allows audio and video communication to work inside web pages by allowing direct peer-to-peer communication, eliminating the need to install plugins or download native apps.[3] Supported by Apple, Google, Microsoft, Mozilla, and Opera, WebRTC is being standardized through the World Wide Web Consortium (W3C) and the Internet Engineering Task Force (IETF).</p>
</div>
<div class="paragraph">
<p>Since its version 1.14 GStreamer directly provides a free WebRTC implementation.
Google Hangouts and <a href="https://jitsi.org/">JitSi</a> are based on WebRTC</p>
</div>
</div>
<div class="sect3">
<h4 id="_installing_gstreamer">Installing Gstreamer</h4>
<div class="paragraph">
<p>Mac OS was not choosen by choice, infact in later sections we&#8217;ll see that the OS doesn&#8217;t  support some dependencies
hence newer plugins do not build during installation. To overcome that we had installed ubuntu in RPi and installed Gstreamer.</p>
</div>
<div class="sect4">
<h5 id="_gstreamer_installation_on_mac_os">Gstreamer installation on MAC OS</h5>
<div class="listingblock">
<div class="title">Installation commands</div>
<div class="content">
<pre>brew search gstreamer</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>brew install gstreamer</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>brew search gst-plugins</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 avfvideosrc capture-screen=true ! autovideosink</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720 ! autovideosink</pre>
</div>
</div>
<div class="paragraph">
<p>Installation of basic is complete, we should also install plugins and developer tools for achieving the objective.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>brew install gst-plugins-good gst-plugins-bad gst-plugins-ugly</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-bbc75.png" alt="All the installed packages/plugins">
</div>
<div class="title">Figure 3. Installed packages</div>
</div>
<div class="paragraph">
<p>These are important for streaming and client sink.</p>
</div>
<div class="paragraph">
<p><a href="https://gstreamer.freedesktop.org/documentation/installing/on-mac-osx.html?gi-language=python">Official installation guide</a></p>
</div>
<div class="sect5">
<h6 id="_final_code_that_runs_on_mac"><strong>Final Code that Runs on MAC</strong></h6>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 autovideosrc ! x265enc !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_gstreamer_installation_on_rpi_raspbian">Gstreamer installation on RPi Raspbian</h6>
<div class="paragraph">
<p>The installation procedure is similar to Mac except that we need to use apt-get. <a href="https://gstreamer.freedesktop.org/documentation/application-development/index.html?gi-language=c">Official Site</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-qt5 gstreamer1.0-pulseaudio</pre>
</div>
</div>
<div class="listingblock">
<div class="title">On a remote RPi using Ubuntu Core [Light weight] or Raspbian</div>
<div class="content">
<pre>ssh mcgokul123@192.168.1.121

sudo snap install classic --devmode --edge

sudo classic

sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-qt5 gstreamer1.0-pulseaudio</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_setting_up_ip_camera">Setting up IP camera</h6>
<div class="paragraph">
<p>The IP of the camera and the router have to match for the RPi to access the IP camera in the local network in the router.
This can either be done by changing the default IP of the router or the camera, here the IP of the router was changed. We can also
fix the IP of the camera and the RPi using DHCP Asset management. After this the camera RTSP stream needs to be reatreamed to wowza using the below code.</p>
</div>
<div class="paragraph">
<p>Initially a decodebin and x264enc was used, but there was a delay of 10-30 sec, hence it was changed to h264 parse.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! decodebin ! video/x-h264, width=1280, height=720, framerate=30/1 ! autovideosink</pre>
</div>
</div>
<div class="paragraph">
<p>After the parse was used [shown below], the load on the RPi reduced, hence the reduction in the overall delay.</p>
</div>
</div>
<div class="sect5">
<h6 id="_final_code_that_runs_on_rpi"><strong>Final Code that Runs on RPi</strong></h6>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! rtph264pay name=pay0 pt=96 !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_final_setup"><strong>Final Setup</strong></h6>
<div class="paragraph">
<p>The IP camera and RPi were connected to the Router(3G) using the LAN ports available in it. The RPi could be connected to the router using WiFI too. Or it can be connected to the Router using another switch or router.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-28a3b.png" alt="bg 28a3b">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-4bf10.png" alt="bg 4bf10">
</div>
<div class="title">Figure 4. Single IP camera</div>
</div>
<div class="paragraph">
<p>A single camera can be connected to a 3G router or multiple cameras in a existing network can add this streamer device built
on RPi to stream all the cameras to multiple streams, each stream name can be stored in a table for different cameras identified using unique MAC address</p>
</div>
<div class="paragraph">
<p>To get the mac addresses</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo nmap -sn &lt;local ip address/24</pre>
</div>
</div>
<div class="paragraph">
<p>Returns somehting like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Nmap scan report for 172.31.14.8
Host is up (0.046s latency).
MAC Address: 4C:56:9D:03:58:44 (Apple)
Nmap scan report for 172.31.14.11
Host is up (0.0056s latency).
MAC Address: B8:31:B5:88:2A:BE (Microsoft)
Nmap scan report for 172.31.14.17
Host is up (0.0058s latency).
MAC Address: 70:BC:10:6F:CC:05 (Microsoft)
Nmap scan report for 172.31.14.28
Host is up (0.016s latency).
MAC Address: 18:81:0E:6C:43:C2 (Apple)
Nmap scan report for 172.31.14.36
Host is up (0.75s latency).
MAC Address: 60:8B:0E:98:2C:6F (Apple)
Nmap scan report for 172.31.14.38
Host is up (0.088s latency).
MAC Address: 70:28:8B:AE:14:13 (Samsung Electronics)
Nmap scan report for 172.31.14.43</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-169d0.png" alt="bg 169d0">
</div>
<div class="title">Figure 5. Multiple IP cameras in a network</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_writing_custom_c_code_for_execution">Writing Custom C code for execution</h5>
<div class="paragraph">
<p>Since Gstreamer is based on C programming language. A comprehensive c code can be written using the functions
available in gstreamer header file gst.h (found in the installation folder) gst-launch1.0 uses these functions for
various CLI commands.</p>
</div>
<div class="paragraph">
<p>The pipeline designs of the CLI are converted to variables and function calls of plugins wherever needed. Python implementation
of Gstreamer functions just converts the commands to CLI which intern are converted to c function calls by the gst-launch1.0.</p>
</div>
<div class="paragraph">
<p>Also c code examples are available for most of test conditions in the git repo. We need to make and run them.
autogen.sh automates all the build.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gcc -Wall helloworld.c -o helloworld $(pkg-config --cflags --libs gstreamer-1.0)</pre>
</div>
</div>
<div class="paragraph">
<p>Remember to include the gstreamer installed folder in the search $PATH. So that the compiler is
able to search for the header files.</p>
</div>
<div class="listingblock">
<div class="title">C code</div>
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">#include &lt;gst/gst.h&gt;

#include &lt;gst/rtsp-server/rtsp-server.h&gt;

#define DEFAULT_RTSP_PORT "8554"

static char *port = (char *) DEFAULT_RTSP_PORT;

static GOptionEntry entries[] = {
  {"port", 'p', 0, G_OPTION_ARG_STRING, &amp;port,
      "Port to listen on (default: " DEFAULT_RTSP_PORT ")", "PORT"},
  {NULL}
};

int
main (int argc, char *argv[])
{
  GMainLoop *loop;
  GstRTSPServer *server;
  GstRTSPMountPoints *mounts;
  GstRTSPMediaFactory *factory;
  GOptionContext *optctx;
  GError *error = NULL;

  optctx = g_option_context_new ("&lt;launch line&gt; - Test RTSP Server, Launch\n\n"
      "Example: \"( decodebin name=depay0 ! autovideosink )\"");
  g_option_context_add_main_entries (optctx, entries, NULL);
  g_option_context_add_group (optctx, gst_init_get_option_group ());
  if (!g_option_context_parse (optctx, &amp;argc, &amp;argv, &amp;error)) {
    g_printerr ("Error parsing options: %s\n", error-&gt;message);
    g_option_context_free (optctx);
    g_clear_error (&amp;error);
    return -1;
  }

  if (argc &lt; 2) {
    g_print ("%s\n", g_option_context_get_help (optctx, TRUE, NULL));
    return 1;
  }
  g_option_context_free (optctx);

  loop = g_main_loop_new (NULL, FALSE);

  /* create a server instance */
  server = gst_rtsp_server_new ();

  g_object_set (server, "service", port, NULL);

  /* get the mount points for this server, every server has a default object
   * that be used to map uri mount points to media factories */
  mounts = gst_rtsp_server_get_mount_points (server);

  /* make a media factory for a test stream. The default media factory can use
   * gst-launch syntax to create pipelines.
   * any launch line works as long as it contains elements named depay%d. Each
   * element with depay%d names will be a stream */
  factory = gst_rtsp_media_factory_new ();
  gst_rtsp_media_factory_set_transport_mode (factory,
      GST_RTSP_TRANSPORT_MODE_RECORD);
  gst_rtsp_media_factory_set_launch (factory, argv[1]);
  gst_rtsp_media_factory_set_latency (factory, 2000);

  /* attach the test factory to the /test url */
  gst_rtsp_mount_points_add_factory (mounts, "/test", factory);

  /* don't need the ref to the mapper anymore */
  g_object_unref (mounts);

  /* attach the server to the default maincontext */
  gst_rtsp_server_attach (server, NULL);

  /* start serving */
  g_print ("stream ready at rtsp://127.0.0.1:%s/test\n", port);
  g_main_loop_run (loop);

  return 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Compile it using the code below</p>
</div>
<div class="listingblock">
<div class="content">
<pre>g++ main.cpp `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` -o gstreamerTest</pre>
</div>
</div>
<div class="sect5">
<h6 id="_dump_of_all_the_lines_of_code_that_were_tested">Dump of all the lines of Code that were tested</h6>
<div class="listingblock">
<div class="title">Linux code</div>
<div class="content">
<pre>gst-launch-1.0 v4l2src device=/dev/video1 ! video/x-h264,width=1920,height=1080,framerate=30/1 ! h264parse ! muxout. pulsesrc device="alsa_input.usb-046d_HD_Pro_Webcam_C920_5A8C986F-02-C920.analog-stereo" ! queue ! audioconvert ! voaacenc ! muxout. flvmux name=muxout streamable=true ! \ rtmpsink location =  'wowz://54.213.46.154:1935/liveStreamCam1/cam1'</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Works</div>
<div class="content">
<pre>gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720 ! autovideosink</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sink to RTSP on Wowza - issue with wowza</div>
<div class="content">
<pre>gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720,framerate=30/1 ! \ rtspsink location =  'wowz://54.213.46.154:1935/liveStreamCam1/cam1'

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720,framerate=30/1 ! \ rtmpsink location =  'rtmp://26980a.entrypoint.cloud.wowza.com/app-7a93:1935'

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! \ rtmpsink location =  'rtmp://26980a.entrypoint.cloud.wowza.com/app-7a93'

gst-launch-1.0 autovideosrc device=/dev/video0 ! ffenc_flv ! flvmux ! video/x-raw,width=1280,height=720! \ rtmpsink location =  ''

gst-launch-1.0 autovideosrc device=/dev/video0 ! flvmux ! video/x-raw,width=1280,height=720! \ rtmpsink location =  ''

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720 ! rtmpsink location =  ''

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720 ! rtmpsink location =  'rtmp://26980a.entrypoint.cloud.wowza.com/app-7a93'

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720 ! rtmpsink location =  'rtmp://26980a.entrypoint.cloud.wowza.com/app-7a93'


gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-h264,width=1920,height=1080,framerate=30/1 ! h264parse ! muxout. pulsesrc device="alsa_input.usb-046d_HD_Pro_Webcam_C920_5A8C986F-02-C920.analog-stereo" ! queue ! audioconvert ! voaacenc ! muxout. flvmux name=muxout streamable=true ! \ rtmpsink location =  'wowz://54.213.46.154:1935/liveStreamCam1/cam1'


 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-h264,width=1920,height=1080,framerate=30/1 ! h264parse ! queue ! \ rtmpsink location =  'wowz://54.213.46.154:1935/liveStreamCam1/cam1'

   gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-h264,width=1920,height=1080,framerate=30/1 ! h264parse ! queue ! \ rtmpsink location =  'rtmp://26980a.entrypoint.cloud.wowza.com/app-7a93'

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-h264,width=1920,height=1080,framerate=30/1 ! h264parse ! queue ! autovideosink


 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-h264,width=1920,height=1080,framerate=30/1 ! queue ! autovideosink

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=720,height=480,framerate=30/1  ! autovideosink

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720,framerate=30/1  ! autovideosink

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! autovideosink

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! \ rtmpsink location =  'wowz://54.213.46.154:1935/liveStreamCam1/cam1'

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! \ rtmpsink location =  'rtmp://26980a.entrypoint.cloud.wowza.com/app-7a93'

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! \ rtmpsink location =  'wowz://54.213.46.154:1935/liveStreamCam1/cam1'

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! autovideosink

 gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! autovideosink</pre>
</div>
</div>
<div class="listingblock">
<div class="title">With local RTSP server</div>
<div class="content">
<pre>gst-launch-1.0 playbin uri=rtsp://192.168.11.100:8888/

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! playbin uri=rtsp://192.168.11.100:8888/

gst-launch-1.0 autovideosrc device=/dev/video0 ! video/x-raw,width=1280,height=720! playbin uri=rtsp://192.168.11.100:8888/

gst-launch-1.0 -v playbin uri=rtsp://localhost:8554/test uridecodebin0::source::latency=300

gst-launch-1.0 playbin uri=rtsp://localhost:8554/test

gst-launch-1.0 playbin uri=rtsp://localhost:8554/test

gst-launch-1.0 rtspsrc location=rtsp://192.168.1.64:554/ latency=10 ! rtph264depay ! avdec_h264 ! autovideosink

gst-launch-1.0 rtspsink location=rtsp://192.168.1.64:554/ autovideosink

gst-launch-1.0 rtspsrc location=rtsp://192.168.1.64:554/ autovideosink

sudo apt-get install libgstreamer1.0-dev</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Pipeline design using CLI</div>
<div class="content">
<pre>gst-launch-1.0 videotestsrc ! videoconvert ! tee name=t ! queue ! autovideosink t. ! queue ! autovideosink

gst-launch-1.0 videotestsrc pattern = 11 ! videoconvert ! tee name=t ! queue ! autovideosink t. ! queue ! autovideosink

gst-launch-1.0 videotestsrc pattern = 11 ! videoconvert ! tee name=t ! queue ! autovideosink t. ! video/x-raw,width=1280,height=720 ! queue ! autovideosink

gst-launch-1.0 videotestsrc pattern = 11 ! videoconvert ! tee name=t ! queue ! autovideosink t. ! video/x-raw,width=1280,height=720 ! queue ! autovideosink t. ! video/x-raw,width=10,height=10 ! queue ! autovideosink

gst-launch-1.0 autovideosrc pattern = 11 ! videoconvert ! tee name=t ! queue ! autovideosink t. ! video/x-raw,width=1280,height=720 ! queue ! autovideosink

--
gst-launch-1.0 autovideosrc pattern = 11 ! videoconvert ! tee name=t ! queue ! autovideosink t. ! video/x-raw,width=720,height=360 ! queue ! autovideosink


GST_DEBUG=2 gst-launch-1.0 flvmux name=mux streamable=true ! rtmpsink</pre>
</div>
</div>
<div class="listingblock">
<div class="title">With correct Wowza RTSP server - works</div>
<div class="content">
<pre>gst-launch-1.0 autovideosrc ! x265enc !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream

gst-launch-1.0 --gst-debug-level=3 multifilesrc location="/home/christoph/GStreamer/rectTest/rect_3840x2160-200x200_%d.png" start-index=1 stop-index=359 do-timestamp=true caps="image/png,framerate=\(fraction\)50/1" ! pngdec ! videoconvert ! videorate ! video/x-raw,framerate=\(fraction\)50/1,width=3840,height=2160 ! x265enc tune=6 speed-preset=9 log-level=4 ! video/x-h265 ! h265parse ! mp4mux ! filesink location=rect_2160p50.mp4


sudo xcode-select -s /Applications/Xcode.app/Contents/Developer

SUDO XCODE-SELECT -S /APPLICATIONS/XCODE.APP/CONTENTS/DEVELOPER</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Building from source using cerebro [brew also has the same option] - didn&#8217;t work in Mac</div>
<div class="content">
<pre>https://gstreamer.freedesktop.org/documentation/installing/building-from-source-using-cerbero.html?gi-language=c</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Getting Stream from CCTV and pushing it to cloud RTSP server</div>
<div class="content">
<pre>gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! decodebin ! x264enc ! rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream


gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! decodebin ! video/x-raw,width=1280,height=720 ! x264enc ! rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream

https://fhackts.wordpress.com/2015/12/11/compiling-glimagesink-for-gles-without-xorg-on-raspberrypi/

https://github.com/thaytan/gst-rpicamsrc/issues/79


gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! decodebin ! video/x-h264, width=1280, height=720, framerate=30/1 ! autovideosink

gst-launch-1.0 videotestsrc ! x264enc ! rtspclientsink location=

gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! rtph264pay name=pay0 pt=96 !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_final_implementation_on_rpi"><strong>Final Implementation on RPi</strong></h4>
<div class="sect4">
<h5 id="_exit_when_not_connected_at_start">Exit when not connected at start</h5>
<div class="paragraph">
<p>We need to make sure the code running is robust so features like restart, start@boot and watchdog has to be built.
This section deals with such an attempt and the learnings thereby.</p>
</div>
<div class="paragraph">
<p>Initially we have a pipeline made in command line which is run after installing the requirements</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-pulseaudio gstreamer1.0-rtsp</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! watchdog timeout=5000 !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
<div class="paragraph">
<p>watchdog is used so that if the buffer is not updates for 5000ms then it throws an error and exits pipeline.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It turns out the pipeline doesn&#8217;t exit if the camera is not connected at start. The program is stuck at Setting pipeline to NULL ..
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hence other methods to solve this were searched</p>
</div>
<div class="olist arabic">
<div class="title">References</div>
<ol class="arabic">
<li>
<p>Please note that gst-launch-1.0 is primarily a debugging tool for developers and users. You should not build applications on top of it. For applications, use the gst_parse_launch() function of the GStreamer API as an easy way to construct pipelines from pipeline descriptions. <a href="https://thiblahute.github.io/GStreamer-doc/tools/gst-launch.html?gi-language=c">Ref</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/14923306/gstreamer-with-visual-c-express-2010-tutorial-1/14928296#14928296">Usage of gst_parse_launch()</a></p>
</li>
<li>
<p><a href="https://docs.gstreamer.com/documentation/tutorials/basic/hello-world.html?gi-language=c">Didn&#8217;t work because of gst_bus_timed_pop_filtered()</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/41698656/convert-gstreamer-command-to-c-code">GST to c code (didn&#8217;t work becuase of bus_call error)</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">GstParse</div>
<p>These function allow to create a pipeline based on the syntax used in the gst-launch-1.0 utility (see man-page for syntax documentation).</p>
</div>
<div class="listingblock">
<div class="title">Final C code</div>
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">#include &lt;gst/gst.h&gt;
#include &lt;stdio.h&gt;

int
main (int argc, char *argv[])
{
    GstElement *pipeline;
    GstElement *filesrc;
    GstMessage *msg;
    GstBus *bus;
    GError *error = NULL;

    gst_init (&amp;argc, &amp;argv);

//    if (argc != 2) {
//        g_print ("usage: %s &lt;filename&gt;\n", argv[0]);
//        return -1;
//    }

    pipeline = gst_parse_launch("rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! watchdog timeout=5000 !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream",&amp;error);
    if (!pipeline) {
        g_print ("Parse error: %s\n", error-&gt;message);
        exit (1);
    }

    filesrc = gst_bin_get_by_name (GST_BIN (pipeline), "my_filesrc");
    g_object_set (filesrc, "location", argv[1], NULL);
    g_object_unref (filesrc);

    gst_element_set_state (pipeline, GST_STATE_PLAYING);

    bus = gst_element_get_bus (pipeline);

    /* wait until we either get an EOS or an ERROR message. Note that in a real
     * program you would probably not use gst_bus_poll(), but rather set up an
     * async signal watch on the bus and run a main loop and connect to the
     * bus's signals to catch certain messages or all messages */
    msg = gst_bus_poll (bus, GST_MESSAGE_EOS | GST_MESSAGE_ERROR, -1);

    switch (GST_MESSAGE_TYPE (msg)) {
        case GST_MESSAGE_EOS: {
            g_print ("EOS\n");
            break;
        }
        case GST_MESSAGE_ERROR: {
            GError *err = NULL; /* error to show to users                 */
            gchar *dbg = NULL;  /* additional debug string for developers */

            gst_message_parse_error (msg, &amp;err, &amp;dbg);
            if (err) {
                g_printerr ("ERROR: %s\n", err-&gt;message);
                g_error_free (err);
            }
            if (dbg) {
                g_printerr ("[Debug details: %s]\n", dbg);
                g_free (dbg);
            }
        }
        default:
            exit(0);
//            g_printerr ("Unexpected message of type %d", GST_MESSAGE_TYPE (msg));
//            if (GST_MESSAGE_TYPE (msg)=='2')
//            {
//                printf("Coming out !  0 ");
//                exit(0);
//            }
            break;
    }

    printf("Coming out !  1 ");

    gst_message_unref (msg);
    printf("Coming out !  2 ");

    gst_element_set_state (pipeline, GST_STATE_NULL);
    gst_object_unref (pipeline);
    gst_object_unref (bus);
    printf("Coming out !  3 ");

    exit(0);
    return 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>exit(0) makes all the difference</p>
</div>
<div class="paragraph">
<p>Now that the system exits we need to proceed to Systemd based restrart and start@boot code.</p>
</div>
</div>
<div class="sect4">
<h5 id="_systemd">Systemd</h5>
<div class="paragraph">
<p><a href="https://www.dexterindustries.com/howto/run-a-program-on-your-raspberry-pi-at-startup/" class="bare">https://www.dexterindustries.com/howto/run-a-program-on-your-raspberry-pi-at-startup/</a></p>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1UGSmPHU5dU?start=99" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Systemd is a cool tool use man systemd.service to explore,Never use ~/ in any of executable
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_creating_a_new_service">Creating a new service</h6>
<div class="listingblock">
<div class="content">
<pre>cd /etc/systemd/system
sudo nano gst.service
chmod +x gst.service</pre>
</div>
</div>
<div class="paragraph">
<p>Inside the service description as below</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Service]
Type=forking
ExecStart = python /home/pi/gst.py  #primary code that is run, see ~ is not used
Restart = always
# WorkingDirectory = ~/
RestartSec = 10 #Restart every 10 seconds

[Install]
WantedBy=multi-user.target  #Important for enabling at restart</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Do not forget to <code>chmod +x gst.service</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo systemctl start gst</pre>
</div>
</div>
<div class="paragraph">
<p>will start the service</p>
</div>
<div class="paragraph">
<p>Also, in gst.py</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import os

#cmd = "gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! watchdog timeout=5000 !$
cmd = "/home/pi/gstreamerTest"
returned_value = os.system(cmd)
print(returned_value)
#if returned_value.split(" ")[-1]</code></pre>
</div>
</div>
<div class="paragraph">
<p>See for the executable ~ is not used</p>
</div>
<div class="paragraph">
<p>Python is used so that a requirement file can be setup and read for dynamically controlling the configuration</p>
</div>
</div>
<div class="sect5">
<h6 id="_start_at_boot">Start at boot</h6>
<div class="paragraph">
<p>Just enable Systemd service</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo systemctl enable gst.service</pre>
</div>
</div>
<div class="paragraph">
<p>Note for this to work [Install] should be defined</p>
</div>
</div>
<div class="sect5">
<h6 id="_final_testing_flow">Final Testing flow</h6>
<div class="listingblock">
<div class="content">
<pre>cd ~
nano gst.c</pre>
</div>
</div>
<div class="paragraph">
<p>Paste this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">#include &lt;gst/gst.h&gt;
#include &lt;stdio.h&gt;

int main (int argc, char *argv[])
{
    GstElement *pipeline;
    GstElement *filesrc;
    GstMessage *msg;
    GstBus *bus;
    GError *error = NULL;

    gst_init(NULL,NULL);

    printf("camera : %s, RTSP Server: %s \n ",argv[1], argv[2]);

//    Creating the final pipline - strcat equivalent
    char buf[256];
    snprintf(buf, sizeof buf, "%s%s%s%s", "rtspsrc location=", argv[1], " ! rtph264depay ! h264parse ! watchdog timeout=5000 !  rtspclientsink location=", argv[2]);

    printf("Final pipeline structure : %s \n", buf);
//    pipeline = gst_parse_launch("rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! watchdog timeout=5000 !  rtspclientsink location=rtsp://13.228.247.239:1935/gst/myStream",&amp;error);
    pipeline = gst_parse_launch(buf,&amp;error);
    printf("Pipeline declared \n");

//    Check if pipeline is ok
    if (!pipeline) {
        g_print ("Parse error: %s\n", error-&gt;message);
        exit (1);
    }

//  Start pipeline to playing
    gst_element_set_state (pipeline, GST_STATE_PLAYING);
    printf("Pipeline set to PLAYING \n");

    bus = gst_element_get_bus (pipeline);

    /* wait until we either get an EOS or an ERROR message. Note that in a real
     * program you would probably not use gst_bus_poll(), but rather set up an
     * async signal watch on the bus and run a main loop and connect to the
     * bus's signals to catch certain messages or all messages */
    msg = gst_bus_poll (bus, GST_MESSAGE_EOS | GST_MESSAGE_ERROR, -1);

    switch (GST_MESSAGE_TYPE (msg)) {
        case GST_MESSAGE_EOS: {
            g_print ("EOS\n");
            break;
        }
        case GST_MESSAGE_ERROR: {
            GError *err = NULL; /* error to show to users                 */
            gchar *dbg = NULL;  /* additional debug string for developers */

            gst_message_parse_error (msg, &amp;err, &amp;dbg);
            if (err) {
                g_printerr ("ERROR: %s\n", err-&gt;message);
                g_error_free (err);
            }
            if (dbg) {
                g_printerr ("[Debug details: %s]\n", dbg);
                g_free (dbg);
            }
        }
        default:
            printf("Coming out ! exit(2) ");
            exit(2);
            break;
    }

    gst_message_unref (msg);
    gst_element_set_state (pipeline, GST_STATE_NULL);
    gst_object_unref (pipeline);
    gst_object_unref (bus);

    return 0;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gcc gst.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` -o gstreamerRUN</pre>
</div>
</div>
<div class="paragraph">
<p>Test working</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gstreamerRUN rtsp://admin:aj123456@192.168.1.64 rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
<div class="paragraph">
<p>Setup config text in /boot/gst.txt</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo nano /boot/gst.txt</pre>
</div>
</div>
<div class="paragraph">
<p>Paste this</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rtsp://admin:aj123456@192.168.1.64
rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s make a gst.py to enable this file handling</p>
</div>
<div class="paragraph">
<p><strong>gst.py</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import os

f= open("/boot/gst.txt", "r")
config = f.read().split("\n")

#cmd = "gst-launch-1.0 rtspsrc location=rtsp://admin:aj123456@192.168.1.64 ! rtph264depay ! h264parse ! watchdog timeout=5000 !$
cmd = "/home/pi/gstreamerRUN "+config[0]+" "+config[1]
returned_value = os.system(cmd)
print(returned_value)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run</p>
</div>
<div class="listingblock">
<div class="content">
<pre>python gst.py</pre>
</div>
</div>
<div class="paragraph">
<p>to test</p>
</div>
<div class="paragraph">
<p>Rest of the steps follow the ones setup for the service above !</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_ui_for_checking_status_of_stream">Building UI for checking status of stream</h4>
<div class="paragraph">
<p>A basic UI was built using PyQt5</p>
</div>
<div class="listingblock">
<div class="title">Code</div>
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import sys
from PyQt5.QtWidgets import QApplication, QLabel, QMainWindow
from PyQt5 import QtGui
from PyQt5.QtCore import Qt, QTimer
import time
import rtsp

rtsp_location = ""

class MainWindow(QMainWindow):

	def __init__(self, *args, **kwargs):
		super(MainWindow, self).__init__(*args, **kwargs)
		self.setWindowTitle("RTSP Server Status")
		self.label = QLabel("")
		self.label.setAlignment(Qt.AlignCenter)
		self.label.setPixmap(QtGui.QPixmap("green.png"))
		self.setCentralWidget(self.label)

		self.i = 0
		self.qTimer = QTimer()
		# self.qTimer.setInterval(2000)
		# self.qTimer.timeout.connect(self.timer_update)
		self.qTimer.setInterval(5000)
		self.qTimer.timeout.connect(self.rtsp_update)
		self.qTimer.start()

	def timer_update(self):
		self.i = (self.i+1)%2
		if self.i:
			self.label.setPixmap(QtGui.QPixmap("green.png"))
		else:
			self.label.setPixmap(QtGui.QPixmap("red.png"))

	def rtsp_update(self):
		client = rtsp.Client(rtsp_server_uri = rtsp_location)
		print("Checking for RTSP server")
		if client.isOpened():
			self.label.setPixmap(QtGui.QPixmap("green.png"))
		else:
			self.label.setPixmap(QtGui.QPixmap("red.png"))


if __name__ == "__main__":
	app = QApplication(sys.argv)
	print (sys.argv[1])
	rtsp_location = str(sys.argv[1])
	window = MainWindow()
	window.show()
	i = 0
	app.exec_()</code></pre>
</div>
</div>
<div class="olist arabic">
<div class="title">Learnings</div>
<ol class="arabic">
<li>
<p>Use QTimer as a simple python timer will not let the QT window run</p>
</li>
<li>
<p>Always use a virtualenv</p>
</li>
<li>
<p>Always prefer self.label - to update later</p>
</li>
<li>
<p>Use</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>pip3 install opencv-python==4.1.2.30</pre>
</div>
</div>
<div class="paragraph">
<p>as otherwise there will be cocoa doesn&#8217;t load <a href="https://stackoverflow.com/questions/60042568/this-application-failed-to-start-because-no-qt-platform-plugin-could-be-initiali">Ref</a>
. Code for checking if the rtsp stream is available</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import rtsp
client = rtsp.Client(rtsp_server_uri = rtsp_location)
client.isOpened() #returns a bool</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Run</div>
<div class="content">
<pre>virtualenv rtsp_status
source rtsp_status/bin/activate
pip3 install pyqt5 rtsp
python3 led.py rtsp://13.228.247.239:1935/gst/myStream</pre>
</div>
</div>
<div class="sect4">
<h5 id="_crontab_based_timlapse_for_rtsp">Crontab based Timlapse for RTSP</h5>
<div class="paragraph">
<p>Crontab log</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grep CRON /var/log/syslog</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://www.thegeekdiary.com/cron-script-does-not-execute-as-expected-from-crontab-troubleshoot/">Important</a></p>
</div>
<div class="paragraph">
<p>For any shell commands please include these lines</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash
. /home/oracle/.bashrc</pre>
</div>
</div>
<div class="paragraph">
<p>And for logging</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* * * * * /home/oracle/script.sh 2&gt; /tmp/crontab_script_log.txt 2&gt;&amp;1</pre>
</div>
</div>
<div class="paragraph">
<p>Make sure variables don&#8217;t have -</p>
</div>
<div class="paragraph">
<p>RTSPSTREAM doesnt have any - in between</p>
</div>
<div class="paragraph">
<p>Capture</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash
. /home/oracle/.bashrc
source /root/timelapse/config.txt

ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-00.jpg"
sleep 13
ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-15.jpg"
sleep 13
ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-30.jpg"
sleep 13
ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-45.jpg"</pre>
</div>
</div>
<div class="paragraph">
<p>Compile to MP4</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash
. /home/oracle/.bashrc
source /root/timelapse/config.txt

date="$(date "+%m_%d_%Y")"
date2="$(date "+%m-%d-%y")"
ffmpeg -f image2 -i $TIMELAPSERAWPATH/%*.jpg -vcodec libx264 -r 60 -strftime 1 $TIMELAPSESOUTPUTPATH/"${date}".mp4 -y
rm $TIMELAPSERAWPATH/*</pre>
</div>
</div>
<div class="paragraph">
<p>Cron</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* * * * *  /root/timelapse/timelapse-capture.sh
55 23 * * * /root/timelapse/timelapse-capture.sh</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo service cron reload</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setting_up_a_cloud_rtsp_media_server"><strong>Setting up a Cloud RTSP Media Server</strong></h4>
<div class="paragraph">
<p>We have been using Wowza cloud media server for pushing out stream to cloud. The reason for pushing it
to cloud were discussed earlier. We just need to create a custom version of wowza server and host it ourselves.</p>
</div>
<div class="paragraph">
<p>To do this a droplet on Digital Oceon was created.</p>
</div>
<div class="paragraph">
<p>Multiple methods were tried to make this objective possible</p>
</div>
<div class="olist arabic">
<div class="title">Objective</div>
<ol class="arabic">
<li>
<p>RTSP Server to push stream to</p>
</li>
<li>
<p>Multiple stream possibilities</p>
</li>
<li>
<p>Playback using multiple devices</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Eventhough RTSP is a very well used protocol, it was not easy to find a opensource solution for the above objectives</p>
</div>
<div class="sect4">
<h5 id="_method_1_gstreamer">Method 1 - Gstreamer</h5>
<div class="paragraph">
<p>Gstreamer being the most common stream porcessing tool. It had a RTSP server library.
Which was found using <a href="https://stackoverflow.com/questions/16015326/streaming-video-into-a-gstreamer-rtsp-server">StackOverFLow</a></p>
</div>
<div class="paragraph">
<p>Although this question was asked long ago but I am going to answer for someone else who might be looking for it. To achieve this using GStreamer.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Gstreamer now has a RTSP media server <a href="https://github.com/GStreamer/gst-rtsp-server">Here</a></p>
</li>
<li>
<p>Gstreamer also has a <a href="https://github.com/GStreamer/gst-rtsp-server/blob/master/gst/rtsp-sink/gstrtspclientsink.c">GstRtspClientSink</a> element which allows you to send a stream to compatible RTSP media server. A basic command line example is "gst-launch-1.0 videotestsrc ! queue ! x264enc ! rtspclientsink location=rtsp://127.0.0.1:8554/test" assuming the media server is running on localhost, port 8554 and expecting a publish point "test"</p>
</li>
<li>
<p>An example of GStreamer RTSP server based application that accepts stream from client is available <a href="https://github.com/GStreamer/gst-rtsp-server/blob/master/examples/test-record.c">Here</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The above package was written in c and poorly documented.
To compile the test-record.c example found in the git page it took so much time
There was always an #include error</p>
</div>
<div class="paragraph">
<p>Finally these two methods worked</p>
</div>
<div class="listingblock">
<div class="title">Compile 1 - GCC</div>
<div class="content">
<pre>export C_INCLUDE_PATH=.:/root/gst-rtsp-server/:/usr/include/gstreamer-1.0/
gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gcc -I/root/gst-rtsp-server/ -I/usr/include/gstreamer-1.0/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Compile 2 - autogen.sh</div>
<p>By building all the gst packages in a virtualenv using git libraries</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash

# Set your target branch
BRANCH="1.14.2"

exec &gt; &gt;(tee build-gstreamer.log)
exec 2&gt;&amp;1

[ ! -d orc ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/orc
[ ! -d gstreamer ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gstreamer
[ ! -d gst-plugins-base ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-plugins-base
[ ! -d gst-plugins-good ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-plugins-good
[ ! -d gst-plugins-bad ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-plugins-bad
[ ! -d gst-libav ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-libav
[ ! -d gst-plugins-ugly ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-plugins-ugly
[ ! -d gst-python ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-python
[ ! -d gst-rtsp-server ] &amp;&amp; git clone git://anongit.freedesktop.org/git/gstreamer/gst-rtsp-server


export LD_LIBRARY_PATH=/usr/local/lib/

cd orc
./autogen.sh --disable-gtk-doc
make
sudo make install
cd ..

cd gstreamer
git checkout $BRANCH
./autogen.sh --disable-gtk-doc
make
sudo make install
cd ..

cd gst-plugins-base
git checkout $BRANCH
./autogen.sh --disable-gtk-doc
make
sudo make install
cd ..

cd gst-libav
git checkout $BRANCH
./autogen.sh --disable-gtk-doc --enable-orc
make
sudo make install
cd ..

cd gst-plugins-good
git checkout $BRANCH
./autogen.sh --disable-gtk-doc
make
sudo make install
cd ..

cd gst-plugins-bad
git checkout $BRANCH
./autogen.sh --disable-gtk-doc --enable-orc
make
sudo make install
cd ..

cd gst-plugins-ugly
git checkout $BRANCH
./autogen.sh --disable-gtk-doc --enable-orc
make
sudo make install
cd ..

# export PYTHON=/usr/bin/python3 (Specify required python version)

cd gst-python
git checkout $BRANCH
./autogen.sh --disable-gtk-doc --noconfigure
# with-libpython-dir -&gt; location of libpython*.so
./configure --with-libpython-dir="/usr/lib/x86_64-linux-gnu"
make
sudo make install
cd ..


cd gst-rtsp-server
git checkout $BRANCH
./autogen.sh --disable-gtk-doc
make
sudo make install
cd ..

sudo ldconfig</pre>
</div>
</div>
<div class="paragraph">
<p>Checkout is important to get the .sh file which build all incluing the examples</p>
</div>
<div class="paragraph">
<p>Then when this was ready, to create a media server in localhost</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd gst-rtsp-server/examples/
./test-record "( decodebin name=depay0 ! autovideosink )"</pre>
</div>
</div>
<div class="paragraph">
<p>This was then sent a videotestsrc stream</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  gst-launch-1.0 videotestsrc ! x264enc ! rtspclientsink location=rtsp://127.0.0.1:8554/test</pre>
</div>
</div>
<div class="paragraph">
<p>Still it throws some CRITICAL warning or doesn&#8217;t work- the pushing sequence exits with an error
Could not receive message. (System error)</p>
</div>
</div>
<div class="sect4">
<h5 id="_method_2_ant_media">Method 2 - Ant Media</h5>
<div class="paragraph">
<p>Ant media is a opensource media server
<a href="https://marketplace.digitalocean.com/apps/ant-media-server-community-edition" class="bare">https://marketplace.digitalocean.com/apps/ant-media-server-community-edition</a>
<a href="https://github.com/ant-media/Ant-Media-Server" class="bare">https://github.com/ant-media/Ant-Media-Server</a></p>
</div>
<div class="paragraph">
<p>With a docker image
<a href="https://github.com/ant-media/Ant-Media-Server/wiki/Installation" class="bare">https://github.com/ant-media/Ant-Media-Server/wiki/Installation</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker build --network=host -t antmediaserver --build-arg AntMediaServer=&lt;Replace_With_Ant_Media_Server_Zip_File&gt; .
docker run --network=host --privileged=true -it antmediaserver</pre>
</div>
</div>
<div class="paragraph">
<p>But Ant Media Server has the ability to pull live streams from external sources. Such as; live TV streams, IP camera streams or other forms of live streams(RTSP, HLS, TS, FLV, etc.). We will first show how to pull live streams with Web Interface.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/ant-media/Ant-Media-Server/wiki/External-Stream-Sources" class="bare">https://github.com/ant-media/Ant-Media-Server/wiki/External-Stream-Sources</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-a5aec.png" alt="Ant Media Pull RTSP Stream">
</div>
</div>
<div class="paragraph">
<p>So a stream URL is needed to pull, not push</p>
</div>
</div>
<div class="sect4">
<h5 id="_method_3_restreamer">Method 3 - Restreamer</h5>
<div class="paragraph">
<p>Restreamer is a software which allows for free real-time video streaming, e.g. transferring video signals of webcams or other video-inputs directly to your website. You can be your own Restreamer streaming provider.</p>
</div>
<div class="paragraph">
<p>This pretty much the same function as pushing to a streaming server</p>
</div>
<div class="paragraph">
<p>Restreamer allows you to transfer H.264 video in HD quality to your own website without streaming providers. You are free to choose your hardware for yourself, the use is free of charge and you remain in possession of your videodata! Restreamer does not charge monthly fees and the streaming is completely free, because it uses your own internet connection. You will be your own video streaming provider. Restreamer is open source and it is free to use for both private and commercial use.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-ce495.png" alt="gst ce495">
</div>
</div>
<div class="paragraph">
<p><a href="https://datarhei.github.io/restreamer/docs/guides-ipcam-rtsp.html" class="bare">https://datarhei.github.io/restreamer/docs/guides-ipcam-rtsp.html</a>
image::images/gst-e5dda.png[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_method_4_docker_cofeescript">Method 4 - Docker CofeeScript</h5>
<div class="paragraph">
<p>A Opensource RTSP/RTMP server code was found here.
<a href="https://github.com/iizukanao/node-rtsp-rtmp-server" class="bare">https://github.com/iizukanao/node-rtsp-rtmp-server</a></p>
</div>
<div class="paragraph">
<p>Docker based implementation was availalble</p>
</div>
<div class="listingblock">
<div class="title">Makefile</div>
<div class="content">
<pre>(docker start ${DOCKER_IMAGE_NAME}) || \
docker run \
-p 8554:80 -p 1935:1935 \
--name ${DOCKER_IMAGE_NAME} -d ${USER}/${DOCKER_IMAGE_NAME}

console:
docker run -it \
-p 8554:80 -p 1935:1935 \
-e an_env_var=${HIDDEN_ENV} \
${USER}/${DOCKER_IMAGE_NAME} bash

.PHONY: build</pre>
</div>
</div>
<div class="paragraph">
<p>-p 8554:80 is used to map 8554 from the system to 80 port of docker where the RTSP server is active
<a href="https://docs.docker.com/config/containers/container-networking/" class="bare">https://docs.docker.com/config/containers/container-networking/</a></p>
</div>
<div class="paragraph">
<p>When a stream was pushed, it was recieved by the RTSP server but VLC playing was not happening
The ffplay also showed no packet recieved</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffplay rtsp://159.65.129.113:80/live/rpi</pre>
</div>
</div>
<div class="paragraph">
<p>This was not solvable</p>
</div>
</div>
<div class="sect4">
<h5 id="_method_5_coffescript_final_working">Method 5 - CoffeScript - <strong>Final Working</strong></h5>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/iizukanao/node-rtsp-rtmp-server.git
cd node-rtsp-rtmp-server
npm install -d</pre>
</div>
</div>
<div class="paragraph">
<div class="title">/start_server.sh did the job</div>
<p>This was put inside systemd to make sure it is always on.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-ba198.png" alt="gst ba198">
</div>
</div>
<div class="paragraph">
<p>As it turns out the solution was simple, but when implemented initially the npm install -d was skipped and a error was thrown.
To overcome this other methods were tried but the solution was right there from the start.</p>
</div>
<div class="paragraph">
<p>Some modification to the coffee files were done</p>
</div>
<div class="listingblock">
<div class="title">config.coffee</div>
<div class="content">
<pre># Server listen port
serverPort: 8554</pre>
</div>
</div>
<div class="paragraph">
<p>So that it doesn&#8217;t stop the server ever.
.server.coffee</p>
</div>
<div class="listingblock">
<div class="content">
<pre>process.on 'uncaughtException', (err) -&gt;
 # streamServer.stop()
 # throw err
 console.log 7</pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">History dump</div>
<div class="content">
<pre>1  sudo apt update
2  sudo apt upgrade -y
3  sudo apt install nginx
4  sudo add-apt-repository universe
5  sudo apt install libnginx-mod-rtmp
6  ls
7  cd node-rtsp-rtmp-server/
8  ls
9  ./start_server.sh
10  sudo cpan AnyEvent::MPRPC::Client
11  ls
12  sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-qt5 gstreamer1.0-pulseaudio
13  sudo apt upgrade
14  ps aux | grep -i apt
15  ps kill apt
16  pkill apt
17  ps kill apt
18  ps aux | grep -i apt
19  sudo apt upgrade -y
20  sudo dpkg --configure -a
21  sudo apt upgrade -y
22  git clone https://github.com/iizukanao/node-rtsp-rtmp-server.git
23  cd node-rtsp-rtmp-server
24  npm install -d
25  apt install npm
26  sudo coffee server.coffee
27  coffee -c *.coffee
28  apt install coffeescript
29  coffee -c *.coffee
30  sudo node server.js
31  sudo coffee server.coffee
32  apt install sequent
33  sudo coffee server.coffee
34  npm install kue
35  sudo coffee server.coffee
36  ls
37  ./start_server.sh
38  coffee server.coffee
39  make build
40  ls
41  npm install --save-dev run-sequence
42  coffee server.coffee
43  ls
44  git clone https://github.com/GStreamer/gst-rtsp-server.git
45  sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-pulseaudio gstreamer1.0-rtsp
46  ls
47  cd gst-rtsp-server/
48  ls
49  cd examples/
50  ls
51  gcc main.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` -o gstreamerRUN
52  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` -o test-RTSP
53  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` -o test-RTSP
54  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp`pkg-config --cflags gstreamer1.0-rtsp -o test-RTSP
55  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
56  cd ..
57  ls
58  cd examples/
59  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --cflags --libs libgstrtspserver-1.0-0` -o test-RTSP
60  cd ..
61  ls
62  make
63  meason build
64  apt install meson
65  meason build
66  meson build
67  ls
68  cd build/
69  ls
70  cd ..
71  ls
72  cd gst/
73  ls
74  cd rtsp-server/
75  ls
76  cd ..
77  ls
78  cd..
79  ls
80  cd ..
81  ls
82  cp examples/test-record.c .
83  ls
84  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
85  ls
86  nano test-record.c
87  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
88  ls gst-rtsp-server/gst/rtsp-server/rtsp-server.h
89  ls ~/gst-rtsp-server/gst/rtsp-server/rtsp-server.h
90  nano test-record.c
91  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
92  ls root/gst-rtsp-server/gst/rtsp-server/rtsp-server.h
93  ls /root/gst-rtsp-server/gst/rtsp-server/rtsp-server.h
94  nano test-record.c
95  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
96  nano test-record.c
97  gcc -I /roor/gst-rtsp-server/  test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
98  gcc -I/roor/gst-rtsp-server  test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
99  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
100  ls
101  cd gst/
102  ls
103  pkg-config --modversion gstreamer-rtsp-server-1.0
104  ls
105  cd gst-rtsp-server/
106  ls
107  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
108  gcc test-record.c -o test-RTSP
109  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
110  cd gst/
111  ls
112  cd rtsp-server/
113  ls
114  cd ..
115  ls
116  cd rtsp-sink/
117  ls
118  cd ..
119  ls
120  cd .
121  cd ..
122  ls
123  nano test-record.c
124  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
125  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gst-plugin-base` -o test-RTSP
126  apt search gst-plugin-base
127  apt list
128  apt list | grep gst
129  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base` -o test-RTSP
130  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base/gst-libs` -o test-RTSP
131  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base` -o test-RTSP
132  nano /root/gst-rtsp-server/gst/rtsp-server/rtsp-session.h
133  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base` -o test-RTSP
134  nano /root/gst-rtsp-server/gst/rtsp-server/rtsp-session.h
135  dpkg -L gstreamer-1.0
136  dpkg -L gstreamer1.0-plugins-base
137  dpkg -L gstreamer1.0-launch
138  dpkg -L gstreamer1.0-plugins-base
139  cd /usr/lib/x86_64-linux-gnu/gstreamer-1.0
140  ls
141  cd /usr/share/doc/gstreamer1.0-plugins-base
142  ls
143  cd ~
144  ls
145  cd gst-rtsp-server/
146  ls
147  cd gst/
148  ls
149  cd ~
150  ls
151  git clone https://github.com/GStreamer/gst-plugins-base.git
152  ls
153  cd gst-
154  cd gst-rtsp-server/
155  ls
156  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base` -o test-RTSP
157  gcc -I /root/gstreamer1.0-plugins-base/gst-libs/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
158  ls
159  cp -r ~/gst-plugins-base/gst-libs/gst/* gst/
160  ls
161  cd gst/
162  ls
163  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base` -o test-RTSP
164  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
165  cd ..
166  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs gstreamer1.0-plugins-base` -o test-RTSP
167  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
168  ls
169  cd gst-rtsp-server/
170  ls
171  cd gst/
172  ;
173  ls
174  cd ..
175  gcc test-record.c `pkg-config --cflags gstreamer-1.0` `pkg-config --libs gstreamer-1.0` `pkg-config --libs gstreamer-1.0-rtsp` `pkg-config --cflags gstreamer1.0-rtsp` -o test-RTSP
176  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
177  gcc -I/root/gst-rtsp-server/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
178  nano /root/gst-rtsp-server/gst/rtsp/gstrtsptransport.h
179  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
180  gcc -I/root/gst-rtsp-server/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
181  ls
182  cs gst
183  cd gst/
184  ls
185  cd rtsp
186  ls
187  cd ~
188  ls
189  cd gst-plugins-base/
190  ls
191  cd gst-libs/
192  ls
193  cd gst/
194  ls
195  cd ..
196  ls
197  cd ..
198  ls
199  cd /usr/include/gstreamer-1.0/
200  ls
201  cd gst/
202  ls
203  cd ~
204  cd gst-rtsp-server/
205  ls
206  gcc -I/usr/include/gstreamer-1.0/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
207  gcc -I/root/gst-rtsp-server/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
208  gcc -I/root/gst-rtsp-server/ -I/usr/include/gstreamer-1.0/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
209  gcc -I/root/gst-rtsp-server/ -I/usr/include/gstreamer-1.0/ test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSPC
210  export C_INCLUDE_PATH=./root/gst-rtsp-server/:/usr/include/gstreamer-1.0/
211  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSPC
212  export C_INCLUDE_PATH=.:/root/gst-rtsp-server/:/usr/include/gstreamer-1.0/
213  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSPC
214  cd /usr/include/gstreamer-1.0/
215  ls
216  cd gst/
217  ls
218  cd ~
219  cd gst-plugins-base/
220  ls
221  cd gst-libs/
222  l
223  cd gst/
224  ls
225  cd rtsp/
226  la
227  cd gst-rtsp-server/
228  ls
229  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
230  export C_INCLUDE_PATH=.:/root/gst-rtsp-server/:/usr/include/gstreamer-1.0/
231  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` -o test-RTSP
232  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
233  libgstreamer-plugins-base1.0-dev
234  apt list | grep libgstreamer-plugins-base
235  cd /libgstreamer-plugins-base1.0-dev
236  apt install libgstreamer-plugins-base1.0-dev
237  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
238  ls
239  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
240  ls
241  cd gst/
242  ls
243  rm -v !(rtsp-*)
244  rm -r -v !(rtsp-*)
245* ex
246  export C_INCLUDE_PATH=.:/root/gst-rtsp-server/:/usr/include/gstreamer-1.0/
247  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
248  cd ..
249  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
250  nano test-record.c
251  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
252  clc
253  clear
254  gcc test-record.c `pkg-config --cflags --libs gstreamer-1.0` `pkg-config --cflags --libs libgstreamer-plugins-base1.0-dev` -o test-RTSP
255  cd ~
256  mkdir test
257  cd for module in gstreamer gst-plugins-base gst-plugins-good; do
258  ls
259  cd test/
260  ls
261  for module in gstreamer gst-plugins-base gst-plugins-good; do   git clone https://gitlab.freedesktop.org/gstreamer/$module ; done
262  ls
263  git clone https://gitlab.freedesktop.org/gstreamer/gst-rtsp-server
264  ls
265  cd gst-rtsp-server/
266  ls
267  cd ..
268  cd gst-plugins-base/
269  ls
270  ls *.sh
271  cd ..
272  l
273  cd gstreamer
274  ls
275  cd gst/
276  ls
277  cd ..
278  ls
279  cd scripts/
280  ls
281  cd ..
282  ./autogen.sh
283  git checkout
284  ls
285  git checkout -t origin/$BRANCH || tru
286  cd ~
287  rm -r test/
288  mkdir test
289  nano build_gst.sh
290  ls
291  mv build_gst.sh test/
292  ls
293  cd test/
294  ls
295  chmod +x build_gst.sh
296  ./build_gst.sh
297  exxit
298  exit
299  ls
300  cd test
301  ls
302  cd gst-rtsp-server/
303  ls
304  cd examples/
305  exit
306  ls
307  cd test/
308  ls
309  gst-launch-1.0 videotestsrc ! x264enc ! rtspclientsink location=rtsp://127.0.0.1:8554/test
310  gst-launch-1.0 videotestsrc ! x264enc ! rtspclientsink location=rtsp://127.0.0.1:8554/test/stream
311  gst-launch-1.0 videotestsrc ! x264enc ! rtspclientsink location=rtsp://127.0.0.1:8554/test
312  ls
313  cd test/
314  ls
315  cd gst-rtsp-server/
316  ls
317  cd ..
318  cd gst-plugins-good/
319  ls
320  cd ..
321  ls
322  atom build-gstreamer.log
323  nano build-gstreamer.log
324  nano build_gst.sh
325  ./build_gst.sh
326  ls
327  cd gst-rtsp-server/
328  ls
329  cd examples/
330  ls
331  ./test-record
332  ./test-record -h
333  ./test-record
334  nano test-record.c
335  ./test-record
336  ./test-record "( decodebin name=depay0 ! autovideosink )
337  ./test-record ( decodebin name=depay0 ! autovideosink )
338  ./test-record "( decodebin name=depay0 ! autovideosink )"
339  ./test-record
340  nano test-record.c
341  mkdir test_stream
342  cd test_stream/
343  virtualenv rtsp_stream
344  apt install virtualenv
345  virtualenv rtsp_stream
346  source rtsp_stream/bin/activate
347  apt install rtsp
348  pip install rtsp
349  pip3 install rtsp
350  apt install python3-pip
351  pip3 install rtsp
352  nano test_stream.py
353  python3 test_stream.py
354  nano test_stream.py
355  python3 test_stream.py
356  nano test_stream.py
357  cd ..
358  ls
359  cd test
360  ls
361  nano build_gst.sh
362  cat build_gst.sh
363  ls
364  cd test_stream/
365  ls
366  python3 test_stream.py
367  source rtsp_stream/bin/activate
368  python3 test_stream.py
369  ls
370  cd test
371  ls
372  cd gst-rtsp-server/
373  ls
374  cd examples/
375  ls
376  ./test-record
377  ./test-record "( decodebin name=depay0 ! autovideosink )"
378  ls
379  git clone https://github.com/iizukanao/node-rtsp-rtmp-server.git
380  rm -rf node-rtsp-rtmp-server/
381  git clone https://github.com/iizukanao/node-rtsp-rtmp-server.git
382  cd node-rtsp-rtmp-server/
383  nano Dockerfile
384  docker build
385  docker build --help
386  ls
387  make build
388  make console
389  sudo make console
390  make run
391  ls
392  ./start_server.sh
393  make console
394  nano Makefile
395  make console
396  exit
397  clear
398  ls
399  cd ~
400  ls
401  mkdir docker
402  cd doc
403  cd docker
404  nano Dockerfile
405  wget https://github-production-release-asset-2e65be.s3.amazonaws.com/83530209/96e47200-8eb5-11ea-90cc-b5ee7e4f2b24?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200505%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20200505T164603Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=dfabb8a92cfb2c2de0aab58b782da8cfdd57fb59c9b9d052b690103fe705b071&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;repo_id=83530209&amp;response-content-disposition=attachment%3B%20filename%3Dant-media-server-2.0.0-community-2.0.0-20200504_1842.zip&amp;response-content-type=application%2Foctet-stream
406  wget "https://github-production-release-asset-2e65be.s3.amazonaws.com/83530209/96e47200-8eb5-11ea-90cc-b5ee7e4f2b24?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200505%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20200505T164603Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=dfabb8a92cfb2c2de0aab58b782da8cfdd57fb59c9b9d052b690103fe705b071&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;repo_id=83530209&amp;response-content-disposition=attachment%3B%20filename%3Dant-media-server-2.0.0-community-2.0.0-20200504_1842.zip&amp;response-content-type=application%2Foctet-stream"
407  ls
408  ls *.zip
409  curl "https://github.com/ant-media/Ant-Media-Server/releases/download/ams-v2.0.0/ant-media-server-2.0.0-community-2.0.0-20200504_1842.zip"
410  ls
411  curl "https://github.com/ant-media/Ant-Media-Server/releases/download/ams-v2.0.0/ant-media-server-2.0.0-community-2.0.0-20200504_1842.zip"
412  wget "https://github.com/ant-media/Ant-Media-Server/releases/download/ams-v2.0.0/ant-media-server-2.0.0-community-2.0.0-20200504_1842.zip"
413  ls
414  rm '96e47200-8eb5-11ea-90cc-b5ee7e4f2b24?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200505%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20200505T164603Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=dfabb8a92cfb2c2de0aab58'
415  ls
416  https://github.com/ant-media/Ant-Media-Server/releases/download/ams-v2.0.0/ant-media-server-2.0.0-community-2.0.0-20200504_1842.zip .
417  ls
418  mv ant-media-server-2.0.0-community-2.0.0-20200504_1842.zip ant.zip
419  ls
420  docker build --network=host -t antmediaserver --build-arg AntMediaServer=ant.zip .
421  apt install docker.io
422  docker build --network=host -t antmediaserver --build-arg AntMediaServer=ant.zip .
423  docker run --network=host --privileged=true -it antmediaserver
424  cd node-rtsp-rtmp-server/
425  ls
426  make console
427  ls
428  nano server.coffee
429  make console
430  make build
431  make console
432  nano Dockerfile
433  cd node-rtsp-rtmp-server/
434  ls
435  rtsp://159.65.129.113:80/live/test
436  npm install -d
437  ./start_server.sh
438  ls
439  nano config.coffee
440  ./start_server.sh
441  ls
442  cd node-rtsp-rtmp-server/
443  ./start_server.sh
444  cd /etc/systemd/system
445  sudo nano gst.service
446  cd ~
447  ls
448  cd /etc/systemd/system
449  sudo nano gst.service
450  chmod +x gst.service
451  sudo systemctl start gst
452  ournalctl -xe
453  journalctl -xe
454  /root/node-rtsp-rtmp-server/start_server.sh
455  sudo nano gst.service
456  sudo systemctl start gst
457  /root/node-rtsp-rtmp-server/start_server.sh
458  sudo nano gst.service
459  sudo systemctl start gst
460  systemctl daemon-reload
461  sudo systemctl start gst
462  sudo systemctl status gst
463  ls
464  git clone https://github.com/trailofbits/algo.git
465  sudo apt install -y python3-virtualenv
466  cd algo/
467  ls
468  python3 -m virtualenv --python="$(command -v python3)" .env &amp;&amp;   source .env/bin/activate &amp;&amp;   python3 -m pip install -U pip virtualenv &amp;&amp;   python3 -m pip install -r requirements.txt
469  nano config.cfg
470  ./algo
471  ssh root@159.89.172.22
472  cd algo/
473  ls
474  cd configs/
475  ls
476  cd 159.89.172.22/
477  ls
478  cd wireguard/
479  ls
480  open mac.png
481  open mac.conf
482  nano mac.conf
483  nano oneplus.conf
484  cd ~
485  ls
486  ssh -r swethac@172.31.14.116:~/Desktop/email_auto/* .
487  scp -r swethac@172.31.14.116:~/Desktop/email_auto/* .
488  ls
489  history &gt; a.txt</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_packaging_a_custom_rpi_image_in_mac">Packaging a custom RPi image [in Mac]</h5>
<div class="paragraph">
<p><a href="https://medium.com/platformer-blog/creating-a-custom-raspbian-os-image-for-production-3fcb43ff3630" class="bare">https://medium.com/platformer-blog/creating-a-custom-raspbian-os-image-for-production-3fcb43ff3630</a></p>
</div>
<div class="paragraph">
<p>Step 1: Clone SD Card</p>
</div>
<div class="listingblock">
<div class="content">
<pre>diskutil list</pre>
</div>
</div>
<div class="paragraph">
<p>Step 2: Multipass</p>
</div>
<div class="literalblock">
<div class="content">
<pre>brew install multipass
multipass launch --name ubuntu-lts</pre>
</div>
</div>
<div class="paragraph">
<p>Step 3: Copy the entire SD card</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd Desktop
sudo dd if=/dev/sdisk2 of=rpi.img</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-f83c1.png" alt="gst f83c1">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">TIP</dt>
<dd>
<p>also enable multipassd</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Step 4: GParted only works in Linux</p>
</div>
<div class="literalblock">
<div class="content">
<pre>multipass mount ~/Desktop ubuntu-lts</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-c604f.png" alt="gst c604f">
</div>
</div>
<div class="paragraph">
<p>Step 5: Shrink using Gparted</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /Users/gokulmc/Desktop/
wget  https://raw.githubusercontent.com/Drewsif/PiShrink/master/pishrink.sh
chmod +x pishrink.sh
#sudo mv pishrink.sh /usr/local/bin</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo ./pishrink.sh /Desktop/rpi.img /Desktop/shrink.img</pre>
</div>
</div>
<div class="paragraph">
<p>Step 6: Compress further using gzip</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gzip -9 /Desktop/shrink.img</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h265_through_aws_kinesis">h265 through AWS Kinesis</h3>
<div class="paragraph">
<p>To install Kinesis SDK</p>
</div>
<div class="paragraph">
<p><a href="https://docs.aws.amazon.com/kinesisvideostreams/latest/dg/producersdk-cpp-rpi.html" class="bare">https://docs.aws.amazon.com/kinesisvideostreams/latest/dg/producersdk-cpp-rpi.html</a></p>
</div>
<div class="paragraph">
<p>Install Git:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get update
sudo apt-get install git</pre>
</div>
</div>
<div class="paragraph">
<p>Install Yacc, Lex, and OpenJDK (Open Java Development Kit):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get install byacc flex
sudo apt-get install openjdk-8-jdk</pre>
</div>
</div>
<div class="paragraph">
<p>Set the JAVA_HOME environment variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-armhf/</pre>
</div>
</div>
<div class="paragraph">
<p>Note
If you reboot the device before building the SDK, you must repeat this step. You can also set this environment variable in your ~/.profile file.</p>
</div>
<div class="paragraph">
<p>CMake is used to build the SDK. Install CMake with the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get install cmake</pre>
</div>
</div>
<div class="paragraph">
<p>Copy the following PEM file to /etc/ssl/cert.pem:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>https://www.amazontrust.com/repository/SFSRootCAG2.pem</pre>
</div>
</div>
<div class="paragraph">
<p>Download AWS Kin.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git clone --recursive https://github.com/awslabs/amazon-kinesis-video-streams-producer-sdk-cpp.git</pre>
</div>
</div>
<div class="paragraph">
<p>GStreamer and JNI is NOT built by default, if you wish to build both you MUST execute cmake .. -DBUILD_GSTREAMER_PLUGIN=ON -DBUILD_JNI=TRUE</p>
</div>
<div class="paragraph">
<p>Before that essential packages have to be installed</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get install libssl-dev libcurl4-openssl-dev liblog4cplus-dev libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev gstreamer1.0-plugins-base-apps gstreamer1.0-plugins-bad gstreamer1.0-plugins-good gstreamer1.0-plugins-ugly gstreamer1.0-tools</pre>
</div>
</div>
<div class="paragraph">
<p>CMAKE</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cmake .. -DBUILD_GSTREAMER_PLUGIN=ON -DBUILD_JNI=TRUE</pre>
</div>
</div>
<div class="paragraph">
<p>BUILD</p>
</div>
<div class="literalblock">
<div class="content">
<pre>make</pre>
</div>
</div>
<div class="paragraph">
<p>Include in path for searchability</p>
</div>
<div class="literalblock">
<div class="content">
<pre>export GST_PLUGIN_PATH=`pwd`/build [if in mail folder]</pre>
</div>
</div>
<div class="sect3">
<h4 id="_testing">Testing</h4>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264, format=avc,alignment=au ! kvssink stream-name="h265" storage-size=512 access-key="AKIAZSYQDTTNJ5O4Y2G6" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264, format=avc,alignment=au ! kvssink stream-name="test1" storage-size=128 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" ! rtph264depay ! video/x-h264, format=avc,alignment=au ! kvssink stream-name="test" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 v4l2src do-timestamp=TRUE device=/dev/video0 ! videoconvert ! video/x-raw,format=I420,width=640,height=480,framerate=30/1 ! x264enc  bframes=0 key-int-max=45 bitrate=500 ! video/x-h264,stream-format=avc,alignment=au,profile=baseline ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Final Working</div>
<p>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264, format=avc,alignment=au ! h264parse ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</p>
</div>
<div class="paragraph">
<p>The issue was the 'rtph264depay' was directly sent to kinesis</p>
</div>
<div class="paragraph">
<p>Then it was replaced and followed by 'rtph264depay ! h264parse ! rtph264pay', but 'kvssink' did not need 'rtph264pay''s source, hence only 'h264parse' was included and it worked.</p>
</div>
<div class="paragraph">
<p>Instead there were confusions in the following areas</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The test 1 stream is getting created but there is no stream in media player - 'Media player itself has a 10sec delay'</p>
</li>
<li>
<p>The CloudWatch metrics do not come except HLS and MPEG-DASH requests - 'The metrics take time to be generated'</p>
</li>
<li>
<p>Produces information not displayed - 'producer information is not displayed even when it works'</p>
</li>
<li>
<p>AWS CLI was pursuid in vain - 'not required for GST based implementation'</p>
</li>
</ol>
</div>
<div class="literalblock">
<div class="title">Results</div>
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264, format=avc,alignment=au ! h264parse ! kvssink stream-name="test1" storage-size=128 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
128, 1280x960px - 10sec delay
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264, format=avc,alignment=au ! h264parse ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
256,1280x960 - 10sec delay
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264, format=avc,alignment=au ! h264parse ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
512, 1280x960 - 9sec
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264 ! h264parse ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
No Change
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! h264parse ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
No Change
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264 ,width=1280,height=720,framerate=30/1 ! h264parse ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secCret-key="rn+SOo45se/3vjYRqwgVGcg+7BQjpe6QaPiXxwaN" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
No Change
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtpi@raspberrypi:~/Desktop/kin/amazon-kinesis-video-streams-producer-sdk-cpp $ gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! rtph264depay ! video/x-h264 ,width=720,height=480,framerate=10/1 ! h264parse ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
No Change
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-1f094.png" alt="gst 1f094">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gst-44164.png" alt="gst 44164">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h265">h265</h4>
<div class="paragraph">
<p>Trying to decode h264 and enc 264</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 rtspsrc location="rtsp://admin:aj123456@192.168.1.64" short-header=TRUE ! videoconvert ! x264enc ! kvssink stream-name="test1" storage-size=512 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
2020-07-28 20:30:54 [1996439568] DEBUG - curlApiCallbacksShutdownActiveRequests(): pActiveRequests hashtable is empty
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="title">Tested the following with no difference</div>
<div class="content">
<pre>gst-launch-1.0 v4l2src do-timestamp=TRUE device=/dev/video0 ! videoconvert ! video/x-raw,format=I420,width=640,height=480,framerate=30/1 ! x264enc  bframes=0 key-int-max=45 bitrate=500 ! video/x-h264,stream-format=avc,alignment=au,profile=baseline ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 v4l2src do-timestamp=TRUE device=/dev/video0 ! videoconvert ! video/x-raw,format=I420,width=640,height=480,framerate=30/1 ! x264enc  bframes=0 key-int-max=45 bitrate=500 ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>gst-launch-1.0 v4l2src do-timestamp=TRUE device=/dev/video0 ! videoconvert ! video/x-raw,format=I420,width=640,height=480,framerate=30/1 ! x264enc ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="title">Does not work</div>
<div class="content">
<pre>gst-launch-1.0 v4l2src do-timestamp=TRUE device=/dev/video0 ! videoconvert ! x264enc ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="literalblock">
<div class="title">h265 enc</div>
<div class="content">
<pre>gst-launch-1.0 v4l2src do-timestamp=TRUE device=/dev/video0 ! videoconvert ! video/x-raw,format=I420,width=640,height=480,framerate=30/1 ! x265enc ! kvssink stream-name="test1" storage-size=256 access-key="AKIAZSYQDTTNH5KOSON3" secret-key="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" aws-region="ap-southeast-1"</pre>
</div>
</div>
<div class="paragraph">
<p>Works but the playback doesn&#8217;t work</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microk8s_with_2_rpis"><strong>MicroK8s with 2 RPis</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://ubuntu.com/blog/building-a-raspberry-pi-cluster-with-microk8s">Ref from Ubuntu</a></p>
</div>
<div class="paragraph">
<p><a href="https://discourse.ubuntu.com/t/how-to-build-a-raspberry-pi-kubernetes-cluster-using-microk8s/14792">Tutorial</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-e5285.png" alt="bg e5285">
</div>
</div>
<div class="paragraph">
<p>Containerised applications help isolate resources of a host OS, leading to increased performance. They also help segregate the resources and therefore optimise their utilisation. Kubernetes is the vessel with which all the containers are coordinated to run on a single host OS, which is a big improvement in terms of resource consumption from VMs where a host OS is needed in every VM instance.</p>
</div>
<div class="paragraph">
<p>Kubernetes hasnt become a buzzword for no reason. It has a myriad of features and benefits that make it so. Ultimately it comes down to automated efficiency. What happens if a container running a work-load goes down? If traffic to a container is too high? What happens if you have so much to work to do that allocating resources is a waste of time? And what happens if you are dealing with confidential data or you need to protect your workload? Well. Kubernetes solves all of those problems and more.</p>
</div>
<div class="paragraph">
<p>With Kubernetes, you can automate the creation, removal and management of resources for all your containers. You tell the platform how much CPU and RAM to allocate to each container. It handles unresponsive, or failed containers automatically, re-allocates the workloads and wont advertise them again until theyre back up and running. And Kubernetes lets you store and manage information such as passwords, SSH key and Auth tokens. So you can deploy and update under a layer of security without having to rebuild container images.</p>
</div>
<div class="sect2">
<h3 id="_microk8s">MicroK8s</h3>
<div class="imageblock">
<div class="content">
<img src="images/bg-e99e3.png" alt="bg e99e3">
</div>
</div>
<div class="paragraph">
<p>MicoK8s is the most minimal, fastest version of K8s out there, that keeps the important features of a standard K8s cluster. It is optimised for the edge with hundreds of thousands of lines of codes taken out to be exactly what you need for managing devices. It makes single-(master)-node cluster deployments of Kubernetes easy to deploy for any purpose. Theres no need to deploy a fully-blown production-grade cluster when youre prototyping or developing, you can test everything on MicroK8s before scaling.</p>
</div>
<div class="paragraph">
<p>Typically devices and device workloads are developed to work in silos. Devices at the edge are failure-prone and managing each and everyone in isolation is cumbersome. If a master node goes down, theres no standard way to fix a device under the downed master device. With MicroK8s you can centrally manage every device in the cluster using a simple UI. It takes the complexity out of updates and roll-backs so that developers or organisations can manage their device estate with ease.</p>
</div>
<div class="paragraph">
<p>Some of the biggest buzzwords that describe this effect are embedded industrial devices, and smart homes. The idea of connecting robots or devices in a home or a factory with the ability to communicate, learn and make decisions. That ability, without large amounts of computation or significant resource management, reaches a hard limit. With MicroK8s and its central node methodology more resources become available, become secure and the value of containers as a scalable way of running workloads is transplanted to the edge.</p>
</div>
<div class="paragraph">
<p>The idea is simple. You connect a series of computers (nodes) over a network so that they can share resources (in a cluster) and execute workloads more quickly, more efficiently or in parallel. There are three types of cluster computers, load balancing clusters, for resource distribution. High-performance clusters, sometimes called supercomputers, to pool resources for high computational cost workloads. And there are high availability clusters that are predominantly for redundancy or failure recovery. You can use MicroK8s for any of the above.</p>
</div>
<div class="paragraph">
<p>A cluster computer aims to make a group of computers appear as one system.  In the beginning, cluster computing was almost exclusively a scaling solution for the enterprise. But since, with the rise of the other technologies discussed here, the benefits have grown to include extreme availability, redundancy resilience, load balancing, automated cross-platform management, parallel processing, resource sharing and capacity on demand. The trick is being able to manage said cluster efficiently. The trick is in K8s.</p>
</div>
<div class="sect3">
<h4 id="_installing_using_ubuntu_server">Installing using Ubuntu Server</h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
MicroK8s is only available for 64-bit Ubuntu images.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Installed Ubuntu server 64 18.04 ( k8s needs a 64bit linux)</p>
</li>
<li>
<p>Install apt-get network manager (need lan or 3g) , nmcli to login to wifi
<a href="https://askubuntu.com/questions/377687/how-do-i-connect-to-a-wifi-network-using-nmcli" class="bare">https://askubuntu.com/questions/377687/how-do-i-connect-to-a-wifi-network-using-nmcli</a></p>
</li>
<li>
<p>Install</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>Snap install microk8s</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
apt-get network manager is required for WiFi SSID based login without GUI
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>snap info microk8s</pre>
</div>
</div>
<div class="sect4">
<h5 id="_adding_a_node">Adding a node</h5>
<div class="listingblock">
<div class="content">
<pre>sudo microk8s.add-node</pre>
</div>
</div>
<div class="paragraph">
<p>This command will generate a connection string in the form of &lt;master_ip&gt;:&lt;port&gt;/&lt;token&gt;.</p>
</div>
<div class="listingblock">
<div class="title">Adding leafnode to masternode(starting node)</div>
<div class="content">
<pre>microk8s.join &lt;master_ip&gt;:&lt;port&gt;/&lt;token&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre>microk8s.join 10.55.60.14:25000/JHpbBYMIevZSAMnmjMHmFwanrOYCWZLu</pre>
</div>
</div>
<div class="paragraph">
<p>Remember to generate add node from the masternode only.</p>
</div>
<div class="paragraph">
<p>Instead we can also convert the Ubuntu server to Ubuntu desktop [Not Tested]
using the following</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ubuntu_desktop_from_servernot_tested">Ubuntu Desktop from Server[Not tested]</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>This has not been tested on RPi, but has been tested on a simple Droplet from Digital Oceon</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Author
</div>
</div>
<div class="paragraph">
<p><a href="https://www.digitalocean.com/community/questions/how-can-i-create-a-vm-with-ubuntu-desktop-in-digital-ocean">DigitalOceon</a>
<a href="https://manuelveronesi.freshdesk.com/support/solutions/articles/19000064973-teamviewer-for-headless-linux-setup-debian-">Teamviewer</a>
<a href="https://www.cyberciti.biz/faq/create-a-user-account-on-ubuntu-linux/">Add user</a></p>
</div>
<div class="sect4">
<h5 id="_install_ubuntu_desktop">Install ubuntu-desktop</h5>
<div class="listingblock">
<div class="content">
<pre>sudo apt update</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt upgrade -y</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt-get install ubuntu-desktop</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt-get install xrdp</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>systemctl enable xrdp</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo ufw allow 3389/tcp</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_create_user">Create user</h5>
<div class="listingblock">
<div class="content">
<pre>sudo adduser libin</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo mkdir /home/libin/.ssh/</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo chmod 0700 /home/libin/.ssh/</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>cp ~/.ssh/authorized_keys /home/libin/.ssh/</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo chown -R libin /home/libin/.ssh</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_install_teamviewer">Install Teamviewer</h5>
<div class="listingblock">
<div class="content">
<pre>cd \tmp</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>wget https://download.teamviewer.com/download/linux/signature/TeamViewer2017.asc</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt-key add TeamViewer2017.asc</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo sh -c 'echo "deb http://linux.teamviewer.com/deb stable main" &gt;&gt; /etc/apt/sources.list.d/teamviewer.list'</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt update</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt install teamviewer</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>teamviewer</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>teamviewer setup</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_development_tool"><strong>Other development tool</strong></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ffmpeg">ffmpeg</h3>
<div class="paragraph">
<p>FFmpeg is a free software project that produces libraries and programs for handling multimedia data. FFmpeg includes libavcodec, an audio/video codec library used by several other projects, libavformat, an audio/video container mux and demux library, and the ffmpeg command line program for transcoding multimedia files. FFmpeg is primarily published under the GNU Lesser General Public License v2.1, and some components may be licensed under the GNU General Public License v2. The program and its libraries are also used around the world by companies and consumers alike.</p>
</div>
<div class="paragraph">
<p>Information about a Video file</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i video.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>Convert mp4 to avi</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i video.mp4 video.avi</pre>
</div>
</div>
<div class="paragraph">
<p>Convert video to audio mp3</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i input.mp4 -vn output.mp3</pre>
</div>
</div>
<div class="paragraph">
<p>Change resolution</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i input.mp4 -filter:v scale=1280:720 -c:a copy output.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>Compress</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i input.mp4 -vf scale=1280:-1 -c:v libx264 -preset veryslow -crf 24 output.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>First 10sec</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i input.mp4 -t 10 output.avi</pre>
</div>
</div>
<div class="paragraph">
<p>Split to multiple files</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i input.mp4 -t 00:00:30 -c copy part1.mp4 -ss 00:00:30 -codec copy part2.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>Merge multiple files</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -f concat -i join.txt -c copy output.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>Merge subtitles</p>
</div>
<div class="listingblock">
<div class="content">
<pre>fmpeg -i input.mp4 -i subtitle.srt -map 0 -map 1 -c copy -c:v libx264 -crf 23 -preset veryfast output.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>Preview video</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffplay video.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>Crop the video</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i input.mp4 -filter:v "crop=w:h:x:y" output.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>===ffmpeg based youtube music downloader/converter</p>
</div>
<div class="listingblock">
<div class="content">
<pre>brew install youtube-dl</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>brew install ffmpeg</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>youtube-dl --help</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Download Playlist :</div>
<p>If the list has all the url (video or playlists)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>for i in `cat list.txt` ; do youtube-dl -w -f worst --no-playlist  $i ; done</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>for file in *.3gp ;do ffmpeg -i "$file" -ar 32k -f mp3 "$file.mp3"; done</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>for file in *.3gp ;do rm "$file"; done</pre>
</div>
</div>
<div class="paragraph">
<p>Rename the downloaded files</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import os
print os.getcwd()
print os.system("ls")
import subprocess
proc=subprocess.Popen('ls *.mp3', shell=True, stdout=subprocess.PIPE, )
output=proc.communicate()[0]
print output</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>f = open('names.txt','w')
print output
f.write(str(output))
os.system('open names.txt')
os.system('cp names.txt nms.txt')


for line in open("names.txt") :
  name=line.rstrip('\n')
  print name
  while (name[-1]!='-' and name[-1]!='_' and name[-1]!='~')
   name = name[:-1]
  name = name[:-1]
  try:
   os.rename(line.rstrip('\n'),name+'.mp3')
  except:
   pass</pre>
</div>
</div>
<div class="sect3">
<h4 id="_create_video_from_pdf_files">Create video from PDF files</h4>
<div class="paragraph">
<p>We need</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>FFMpeg</p>
</li>
<li>
<p>ImageMagick</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Convert PDF pages to PNG images</p>
</div>
<div class="listingblock">
<div class="content">
<pre>convert -density 400 input.pdf picture.png</pre>
</div>
</div>
<div class="paragraph">
<p>This will store as picture-1.png, picture-2.png, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -r 1/10 -i picture-%01d.png -c:v libx264 -r 30 -pix_fmt yuv420p video.mp4</pre>
</div>
</div>
<div class="paragraph">
<p>To convert to higher resolution video, no need to do it all over again
Just upscale the video using</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i video.mp4 -vf scale=-1:720 video_720p.mp4</pre>
</div>
</div>
<div class="sect4">
<h5 id="_most_used_ffmpeg_commands">Most used ffmpeg commands</h5>
<div class="listingblock">
<div class="content">
<pre>ffmpeg -i rtst_status.mov -filter:v fps=fps=4 rtst_status_red.mov
ffmpeg -i rtst_status_red.mov -filter:v "setpts=0.25*PTS"  rtst_status_red_4x.mov</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_docker">Docker</h3>
<div class="imageblock">
<div class="content">
<img src="images/bg-3eade.png" alt="bg 3eade">
</div>
</div>
<div class="paragraph">
<p>Docker is an open platform for developing, shipping, and running applications. Docker enables you to separate your applications from your infrastructure so you can deliver software quickly. With Docker, you can manage your infrastructure in the same ways you manage your applications. By taking advantage of Dockers methodologies for shipping, testing, and deploying code quickly, you can significantly reduce the delay between writing code and running it in production.</p>
</div>
<div class="paragraph">
<p>Docker provides the ability to package and run an application in a loosely isolated environment called a container. The isolation and security allow you to run many containers simultaneously on a given host. Containers are lightweight because they dont need the extra load of a hypervisor, but run directly within the host machines kernel. This means you can run more containers on a given hardware combination than if you were using virtual machines. You can even run Docker containers within host machines that are actually virtual machines!</p>
</div>
<div class="paragraph">
<p>Docker provides tooling and a platform to manage the lifecycle of your containers:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Develop your application and its supporting components using containers.</p>
</li>
<li>
<p>The container becomes the unit for distributing and testing your application.</p>
</li>
<li>
<p>When youre ready, deploy your application into your production environment, as a container or an orchestrated service. This works the same whether your production environment is a local data center, a cloud provider, or a hybrid of the two.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Docker Engine</strong> is a client-server application with these major components:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A server which is a type of long-running program called a daemon process (the dockerd command).</p>
</li>
<li>
<p>A REST API which specifies interfaces that programs can use to talk to the daemon and instruct it what to do.</p>
</li>
<li>
<p>A command line interface (CLI) client (the docker command).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The CLI uses the Docker REST API to control or interact with the Docker daemon through scripting or direct CLI commands. Many other Docker applications use the underlying API and CLI.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-f5df3.png" alt="bg f5df3">
</div>
</div>
<div class="paragraph">
<div class="title">The Docker daemon</div>
<p>The Docker daemon (dockerd) listens for Docker API requests and manages Docker objects such as images, containers, networks, and volumes. A daemon can also communicate with other daemons to manage Docker services.</p>
</div>
<div class="paragraph">
<div class="title">The Docker client</div>
<p>The Docker client (docker) is the primary way that many Docker users interact with Docker. When you use commands such as docker run, the client sends these commands to dockerd, which carries them out. The docker command uses the Docker API. The Docker client can communicate with more than one daemon.</p>
</div>
<div class="paragraph">
<div class="title">Docker registries</div>
<p>A Docker registry stores Docker images. Docker Hub is a public registry that anyone can use, and Docker is configured to look for images on Docker Hub by default. You can even run your own private registry. If you use Docker Datacenter (DDC), it includes Docker Trusted Registry (DTR).</p>
</div>
<div class="paragraph">
<p>When you use the docker pull or docker run commands, the required images are pulled from your configured registry. When you use the docker push command, your image is pushed to your configured registry.</p>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/zJ6WbK9zFpI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div class="imageblock">
<div class="content">
<img src="images/bg-4c972.png" alt="bg 4c972">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes">Kubernetes</h3>
<div class="paragraph">
<p>Kubernetes (commonly stylized as k8s) is an open-source container-orchestration system for automating application deployment, scaling, and management. It was originally designed by Google, and is now maintained by the Cloud Native Computing Foundation. It aims to provide a "platform for automating deployment, scaling, and operations of application containers across clusters of hosts". It works with a range of container tools, including Docker. Many cloud services offer a Kubernetes-based platform or infrastructure as a service (PaaS or IaaS) on which Kubernetes can be deployed as a platform-providing service. Many vendors also provide their own branded Kubernetes distributions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-b0f67.png" alt="bg b0f67">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift">Openshift</h3>
<div class="paragraph">
<p>OpenShift is a family of containerization software developed by Red Hat. Its flagship product is the OpenShift Container Platforman on-premises platform as a service built around Docker containers orchestrated and managed by Kubernetes on a foundation of Red Hat Enterprise Linux. The family&#8217;s other products provide this platform through different environments: OKD serves as the community-driven upstream (akin to Fedora), OpenShift Online is the platform offered as software as a service, and Openshift Dedicated is the platform offered as a managed service.</p>
</div>
<div class="paragraph">
<p>The Openshift UI has various functionalities, allowing one to monitor the container resources, container health, the nodes the containers reside on, IP addresses of the nodes, etc. The key store can be accessed via the Secrets in Openshift. The OC CLI command line tool also offers similar functionalities.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-b74e2.png" alt="bg b74e2">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bigpipe">Bigpipe</h3>
<div class="paragraph">
<p><a href="https://medium.com/@arpingajjar/faster-web-page-loading-with-facebook-bigpipe-fbbc49b28959">Source</a></p>
</div>
<div class="paragraph">
<p>From the clients perspective, the Web environment is getting harder to understand as Content-Rich Web services become popular by adopting AJAX-based asynchronous processing. There is no doubt that the Web environment will become chaotic if HTML5 becomes popular without any preparation, which seems likely since HTML5, with various client APIs, is already finding its niche. I believe a whole new age of Web environment is on its way.
The more complex the Web becomes, the more important it is to have servers and clients that offer better performance. In response to such demands, there are already many Web optimization methods available , and in fact, many sites are enjoying great benefits by applying these methods.
Facebook, which is competing fiercely with Google over the initiative in the future Web service, disclosed a new Web service technology called BigPipe which provides a much better user-perceived speed on its SNS. Lets look into it deeper and see how the user-perceived speed could be enhanced, which is what this technology is all about.</p>
</div>
<div class="paragraph">
<div class="title">Motivation</div>
<p>For an SNS such as Facebook, the major contents must be processed based on personalized data. This means that there is always an inevitable limit to any improvement in performance that is achieved only by improving the speed of the server, such as the cache application and system structure. Facebook found the solution to this limit on performance in a new transfer format, and parallel processing between the server and the client. The solution is particularly focused on reducing the delay in showing the page that is requested.</p>
</div>
<div class="paragraph">
<div class="title">Problem</div>
<p>When the Web server is overloaded while generating a page, in most cases the browser becomes idle and does nothing. When the server finishes generating the page and sends it to the browser at once, it cause a bottleneck effect, both in traffic and in performance. Therefore, the server that has already completed transfer cannot be helpful any more. By overlapping the time taken for the server to generate pages and for the browser to render, you can not only reduce the end-to-end latency but also the initial response time for the Web page, consequently reducing overall loading time. The problem in which a single slow query holds back the entire loading process can be addressed as well.</p>
</div>
<div class="paragraph">
<div class="title">BigPipe</div>
<p>BigPipe is a technology that combines existing Web technologies to allow the parallel processing to generate Web pages and render browsers simultaneously (just as AJAX did). It is named because its mechanism is similar to Pipelining which is common for microprocessors. For this reason, Facebook calls BigPipe technology a Web page pipeline for better performance.</p>
</div>
<div class="paragraph">
<div class="title">Chunked encoding</div>
<p>Chunked Encoding is an encoding method of transfer supported in HTTP 1.1 and higher, which allows the server to ignore the header value and divide the response result from HTTP into a series of chunks, and then transfer each chunk of the result. The size of each chunk is transferred along with the content. With this feature, the server can send a response to the Web browser in the middle of a process (Flush transfer) so that the user can see at least partial content.</p>
</div>
<div class="paragraph">
<div class="title">Working</div>
<p>BigPipe is a technology that allows parallel processing between the page generation of the Web server and the rendering process of a browser by using the Script Flush method described above. It divides a page into small pieces to enable this type of parallel processing, so that it independently processes the entire Life Cycle from creating each HTML to displaying on the screen through Flush transfer to the browser, and it is named Pagelet (which means a page that is smaller than a normal one such as Applet and Servlet).</p>
</div>
<div class="paragraph">
<div class="title">Pagelet</div>
<p>Pagelet is a small piece of the page which is an independent section of the page for browsers, and is a result of an individual Thread in parallel processing to generate the page for Web servers. See these actual Facebook pages as an example of how how Web pages are broken into small Pagelets.
image::images/bg-e9c96.png[]</p>
</div>
<div class="paragraph">
<div class="title">Lifecycle</div>
<p>Life Cycle
In BigPipe, the Life Cycle of a users requests are as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The browser sends an HTTP request to the server.</p>
</li>
<li>
<p>After receiving the HTTP request and identifying the effectiveness, the server immediately sends an unclosed HTML document (&lt;/body&gt;&lt;/html&gt; tags are taken out) to a browser by using Flush transfer, which is the Chunked Encoding method. The &lt;head&gt; tag includes the JavaScript library that can workwith the JavaScript code by using Script Flush. The &lt;body&gt; tag consists of a type of template, mostly by using &lt;div&gt; tags to define the logical structure of the divided pages and the possessing structure of Pagelet. For example:</p>
</li>
<li>
<p>After flushing the first response to the client, the Web server continues to generate Pagelets one by one. As soon as a Pagelet is generated, its response is transferred to the client immediately as a JSON-encoded object that includes all the CSS, the JavaScript resources needed for the Pagelet, and its HTML content, as well as some meta data.</p>
</li>
<li>
<p>At the client side, upon receiving a Pagelet response via onPageletArrive call, BigPipes JavaScript library first downloads its CSS resources; after the CSS resources are downloaded, BigPipe displays the Pagelet by setting its corresponding placeholder divs innerHTML to the Pagelets HTML markup. The CSS of Multiple Pagelets can be downloaded simultaneously. In addition, Pagelets can be displayed without any obvious order, depending on whose CSS download finishes earlier.</p>
</li>
<li>
<p>BigPipe wont start downloading JavaScript for any Pagelet until all Pagelets in the page have been displayed. Still, Pagelets are asynchronously downloaded and executed. JavaScript resource is given a lower priority than CSS and page content because it is faster to display Pagelets on the page through CCS and HTML and then executing JavaScript and download. This is the case not only for BigPipe, but also for normal Web page serving.</p>
</li>
<li>
<p>Once all Pagelet generation and response transfer is done at the server, the tags below are sent last to complete the page structure.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>&lt;/body&gt;</p>
</div>
<div class="paragraph">
<p>&lt;/html&gt;</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-0830a.png" alt="bg 0830a">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-27d72.png" alt="bg 27d72">
</div>
</div>
<div class="paragraph">
<p>In BigPipe, parallel processing between the server and the browser requires Pagelet generation at the server in parallel. But if parallel processing is difficult due to the structure, or if there is a bottleneck when pulling data along with DB queries, sequential processing instead of parallel processing can help reduce initial rendering time, because as long as you make sure that the sequence is right, you can display Pagelet results on the screen right away.</p>
</div>
</div>
<div class="sect2">
<h3 id="_amp">AMP</h3>
<div class="paragraph">
<p>AMP is a web component framework that you can use to easily create user-first websites, stories, emails, and ads.</p>
</div>
<div class="paragraph">
<p>AMP (originally an acronym for Accelerated Mobile Pages) is an open source HTML framework developed by the AMP Open Source Project. It was originally created by Google as a competitor to Facebook Instant Articles and Apple News. AMP is optimised for mobile web browsing and intended to help webpages load faster. AMP pages may be cached by a CDN, such as Microsoft Bing or Cloudflare&#8217;s AMP caches, which allows pages to be served more quickly.</p>
</div>
<div class="paragraph">
<div class="title">Motivation</div>
<p>In a society hooked on instant gratification, people dont like waiting for things. Thats why over 25% of visitors will leave a website that doesnt load in six seconds. Thats the length of a Vine (RIP).</p>
</div>
<div class="paragraph">
<p>Fortunately, in 2016, Google launched their solution to sluggish mobile web pages.</p>
</div>
<div class="paragraph">
<p>They called it "The Accelerated Mobile Pages Project" or "The AMP Project", and the technology can load web pages in less than one second and use 10 times less data than regular web pages.</p>
</div>
<div class="paragraph">
<div class="title">How</div>
<p>Google AMP is a website publishing technology that lets you create web pages that load almost instantly on mobile phones. Since its inception in early 2016, over 25 million domains have published more than 1.5 billion AMP pages.</p>
</div>
<div class="paragraph">
<p>To build AMP pages, you need to create another version of your site that follows the AMP projects standards. Once you do that, your AMP site will have its own URL (site.com/page/amp) and be compatible with most popular web browsers like Chrome, FireFox, and Safari.</p>
</div>
<div class="paragraph">
<p>Visiting an AMP page through a Google search is when they load the fastest&#8201;&#8212;&#8201;Google will host the page on its own servers and serve up the content directly on its site. Its just like Facebook Instant Articles, which lets users read articles without leaving Facebooks mobile app.</p>
</div>
<div class="paragraph">
<p>The big difference between the two technologies is that youre not limited to embedding AMP pages on one platform like you are with Instant Articles. A laundry list of popular search engines, social platforms, content management systems, and eCommerce websites support AMP, like Bing, LinkedIn, Pinterest, Reddit, Twitter, Medium, WordPress, Squarespace, Tumblr, eBay, and BigCommerce.</p>
</div>
<div class="paragraph">
<p>Google also gives AMP pages preferential treatment in its search rankings&#8201;&#8212;&#8201;AMP is now a requirement for news stories to rank number one in their mobile search results.</p>
</div>
<div class="paragraph">
<p>But AMP pages enhanced load speed and boosted search rankings come with an ironic trade-off: backlinks to AMP pages found through Google search wont transfer any link equity to your site. A referring domains link equity will go straight to Googles domain since the page is technically hosted on Googles website. According to the tech giant, theres no way Google can prioritize AMP pages in search without hosting the content on their AMP Cache servers.</p>
</div>
<div class="paragraph">
<p>In terms of advertising, though, publishers dont receive the short end of the stick like they do with link building. In 2016, AMP launched the AMP Ads Initiative to provide publishers with ads that load up to five seconds faster than before, are easier to build, have new creative formats, and are supported by over 160 ad networks and 45 analytics platforms. This has helped the Washington Post, Vox, and CNN generate the same amount of advertising revenue from AMP pages as their standard mobile pages.</p>
</div>
<div class="paragraph">
<p>With AMPs soaring popularity, it might seem like Google has gained even more control over internet publishers, especially content creators who write for the mobile web. But marketers must remember that AMP can load their web pages faster than ever before and, in turn, give their audience what they truly crave: instant access to content.</p>
</div>
</div>
<div class="sect2">
<h3 id="_buddy_kubernetes_automated_deployment">Buddy - Kubernetes Automated Deployment</h3>
<div class="paragraph">
<p><a href="https://buddy.works/guides/how-optimize-kubernetes-workflow">Buddy</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-35db7.png" alt="bg 35db7">
</div>
</div>
<div class="paragraph">
<p>Buddy is a Continuous Delivery tool that you can use to automate your whole K8s release workflow, including:</p>
</div>
<div class="paragraph">
<p>managing configuration changes of a K8s Deployment
deployments of code changes
managing Dockerfile updates
building Docker images and pushing them to the Docker registry
applying new images on your K8s cluster</p>
</div>
</div>
<div class="sect2">
<h3 id="_ipmac_based_networking">IP/Mac based networking</h3>
<div class="imageblock">
<div class="content">
<img src="images/bg-8c743.png" alt="bg 8c743">
</div>
</div>
<div class="paragraph">
<p>In computer networks, all the network devices can connect and communicate with each other. But a question always arises in our mind that how one device will uniquely identify the other device in the network. This can be possible only with the help of the MAC and IP addresses. Now, again there is a confusion between these two. So, before defining them, let us first take an example to explain them.</p>
</div>
<div class="paragraph">
<p>For Example, if someone has to send a courier to some other person. The sender has to specify two things about the receiver in order to successfully send the courier. The two things are - Receiver&#8217;s address(it may contain house number, street, city, state, and pin code), and the receiver&#8217;s name(in order to specifically identify the right person to deliver the courier). If we correlate this example in networking, then the IP address will be the address of the network connection in which multiple devices can be present, and the MAC address will be the address of specific nodes, where we want to deliver the data.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll learn about these two addresses in detail. We&#8217;ll also learn the dissimilarities between them. Now let us see about them one by one.</p>
</div>
<div class="sect3">
<h4 id="_ip_addressinternet_protocol_address">IP Address(Internet Protocol Address)</h4>
<div class="paragraph">
<div class="title">An IP address is an address that uniquely identifies a network connection. It is termed as the 'Logical Address' which is provided to a connection in a network.</div>
<p>IP addresses are generally provided by the administrator of the network or the Internet Service Providers(ISP). It can be static or dynamic in nature. It may be temporary and keep on changing each time whenever a device connects to different networks. IP addresses are available in binary form. It is mainly used in routing operation as it specifically identifies a network connection. It is used in the network layer of the OSI or TCP/IP reference models.</p>
</div>
<div class="paragraph">
<p>There are mainly two types of IP addresses:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>IPv4(Internet Protocol Version 4)</strong>: IPv4 is a 32-bits address. This address is available in decimal form along with dots(.) in between. For Example - 192.168.0.11. The header field of the IPv4 is 20 bytes, and the checksum bits are present in the header for error control. The IPsec support(for security feature) is optional in IPv4. The optional fields are also available in the IPv4 addressing. It supports a packet size of up to 576 bytes. The IPv4 addressing can be used for Multicasting and Broadcasting the data packets.</p>
</li>
<li>
<p><strong>IPv6(Internet Protocol Version 6)</strong>: IPv6 is a 128-bits address. This address is available in hexadecimal form along with semi-colons(:) in between. For Example: 2FFE:F300:0213:AB01:0132:7289:2134:ABDC. The header field of the IPv6 is 40 bytes, but the checksum bits are not present in the header file. The IPsec support(for security feature) is mandatory in IPv6. The optional fields are not also available in IPv6 addressing. It supports a packet size of up to 1280 bytes. The IPv6 addressing can not be used for broadcasting.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_mac_addressmedia_access_control_address">MAC Address(Media Access Control Address)</h4>
<div class="paragraph">
<div class="title">MAC address is the address that uniquely identifies a node on the network. It is also called the physical address, or the Burnt-In address, or the software address. The MAC address is provided by the manufacturer of the NIC(Network Interface Card). It is embedded into the hardware and remains constant for that device.</div>
<p>MAC is a 48 bits address which either contains 6 groups of 2 hexadecimal digits, or 3 groups of 4 hexadecimal devices. These hexadecimal digits can be separated either by hyphens(-) or colons(:). For example: 23-AB-CD-EF-56-78, OR 23AB:CDEF:5678. The 48 bits MAC address has two parts of 24 bits each. The first 24 bits represent the OUI(Organization Unique Identifier), and the next 24 bits represent the vendor&#8217;s specific information. The MAC address works on the Data-Link Layer of the OSI or TCP/IP reference models.</p>
</div>
<div class="paragraph">
<p>Following are the dissimilarities between the MAC and IP address:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Purpose</strong>: IP address is mainly used to identify the connection of a node on the network, while the MAC address is used to identify the unique address of that node.</p>
</li>
<li>
<p><strong>Address Type</strong>: The IP address is a software-based or logical address, while the MAC address is a hardware-based, burnt-in, or physical address.</p>
</li>
<li>
<p><strong>Address Provider</strong>: The IP address is provided by the administrator of the network, DHCP(Dynamic Host Configuration Protocol), or the ISP(Internet Service Provider). On the other hand, the MAC address is provided by the device manufacturer and is embedded in the NIC(Network Interface Card).</p>
</li>
<li>
<p><strong>Address Length and Representation</strong>: In IP address, Ipv4 has an address length of 32-bits, while IPv6 has an address length of 128-bits. On the other hand, the MAC address is a 48-bits address. Also, the IP address is represented in the binary format with dots(.) in between, while the MAC address is represented in the hexadecimal formal with hyphens(-) or colons(:) in between.</p>
</li>
<li>
<p><strong>Network Classes</strong>: The IP addresses uses all kinds of network classes, i.e., A, B, C, D, and E for addressing a connection. On the other hand, no such network classes are used for addressing the MAC address for a specific device.</p>
</li>
<li>
<p><strong>Subnetting</strong>: Subnetting is the process of dividing a network into two or more small networks. IP address uses subnetting, while the MAC address does not use it.</p>
</li>
<li>
<p><strong>Flexibility</strong>: The IP address is flexible in nature, it gets changed whenever a device connects to some other network. On the other hand, the MAC addresses are not flexible and remain constant for a device.</p>
</li>
<li>
<p><strong>Network Traffic Used</strong>: The IP address can be used for Multicasting or Broadcasting, while the MAC address can be used for broadcasting.</p>
</li>
<li>
<p><strong>Implementation Layer</strong>: The IP address or logical addressing is implemented in the Network layer of the OSI or TCP/IP model. On the other hand, the MAC address or physical addressing is implemented in the Data-Link layer of the OSI or TCP/IP reference model.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-563a7.png" alt="bg 563a7">
</div>
</div>
<div class="paragraph">
<p>Back in time, networks were created: some computers would communicate with each other to share something. TO do that, they need to know who was talking and who was being talked to. So, instead of giving each computer a name, we gave them an ID. This ID is called MAC address, is should uniquely identity each computer.</p>
</div>
<div class="paragraph">
<p>There wasn&#8217;t a unique specification on how computers would talk to each other: many protocols appeared: TCP/IP, IPX/SPX, and so on. Each protocol would specify things as they thought was ok. For example, IPX/SPX would address each computer using the MAC address and some more information.</p>
</div>
<div class="paragraph">
<p>So, if a TCP/IP address needs to comunicate with another, is just uses the TCP/IP address. But <strong>the network devices need to know to which network card that message is going, so they, somehow, translate the TCP/IP address with to the MAC address.</strong></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
all devices are built to take care of the MAC address, in that low-level requirement, and cannot need to be changed
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_telnet">Telnet</h3>
<div class="paragraph">
<p>Telnet is an application protocol used on the Internet or local area network to provide a bidirectional interactive text-oriented communication facility using a virtual terminal connection. User data is interspersed in-band with Telnet control information in an 8-bit byte oriented data connection over the Transmission Control Protocol (TCP).</p>
</div>
<div class="paragraph">
<p>The word Telnet also refers to the command-line utility telnet, available under Windows OS and Unix-like systems, including Mac, Linux, and others. We will use the term Telnet mostly in the context of the telnet client software.</p>
</div>
<div class="paragraph">
<p>Telnet utility allows users to test connectivity to remote machines and issue commands through the use of a keyboard. Though most users opt to work with graphical interfaces, Telnet is one of the simplest ways to check connectivity on certain ports.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>telnet [domain name or ip] [port]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nmap">Nmap</h3>
<div class="paragraph">
<p>Nmap (Network Mapper) is an open source tool for network exploration and security auditing. It was designed to rapidly scan large networks, although it works fine against single hosts. Nmap uses raw IP packets in novel ways to determine what hosts are available on the network, what services (application name and version) those hosts are offering, what operating systems (and OS versions) they are running, what type of packet filters/firewalls are in use, and dozens of other characteristics. While Nmap is commonly used for security audits, many systems and network administrators find it useful for routine tasks such as network inventory, managing service upgrade schedules, and monitoring host or service uptime.</p>
</div>
<div class="paragraph">
<p>The output from Nmap is a list of scanned targets, with supplemental information on each depending on the options used. Key among that information is the interesting ports table. That table lists the port number and protocol, service name, and state. The state is either open, filtered, closed, or unfiltered. Open means that an application on the target machine is listening for connections/packets on that port. Filtered means that a firewall, filter, or other network obstacle is blocking the port so that Nmap cannot tell whether it is open or closed. Closed ports have no application listening on them, though they could open up at any time. Ports are classified as unfiltered when they are responsive to Nmap&#8217;s probes, but Nmap cannot determine whether they are open or closed. Nmap reports the state combinations open|filtered and closed|filtered when it cannot determine which of the two states describe a port. The port table may also include software version details when version detection has been requested. When an IP protocol scan is requested (-sO), Nmap provides information on supported IP protocols rather than listening ports.</p>
</div>
<div class="paragraph">
<p><a href="https://highon.coffee/blog/nmap-cheat-sheet/">Cheat Sheet</a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -sP 10.0.0.0/24</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ping scans the network, listing machines that respond to ping.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -p 1-65535 -sV -sS -T4 target</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full TCP port scan using with service version detection - usually my first scan, I find T4 more accurate than T5 and still "pretty quick".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -v -sS -A -T4 target</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints verbose output, runs stealth syn scan, T4 timing, OS and version detection + traceroute and scripts against target services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -v -sS -A -T5 target</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection + traceroute and scripts against target services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -v -sV -O -sS -T5 target</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -v -p 1-65535 -sV -O -sS -T4 target</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints verbose output, runs stealth syn scan, T4 timing, OS and version detection + full port range scan.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>nmap -v -p 1-65535 -sV -O -sS -T5 target</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection + full port range scan.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_graphana">Graphana</h3>
<div class="paragraph">
<p>Grafana allows you to query, visualize, alert on and understand your metrics no matter where they are stored. Create, explore, and share dashboards with your team and foster a data driven culture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-13488.png" alt="bg 13488">
</div>
</div>
<div class="paragraph">
<p>Grafana is a multi-platform open source analytics and interactive visualization software available since 2014. It provides charts, graphs, and alerts for the web when connected to supported data sources. It is expandable through a plug-in system. End users can create complex monitoring dashboards using interactive query builders.</p>
</div>
<div class="paragraph">
<p>As a visualization tool, Grafana is a popular component in monitoring stacks, often used in combination with time series databases such as Prometheus and Graphite; monitoring platforms such as Sensu, Icinga, Zabbix, Netdata, and PRTG; SIEMs such as Elasticsearch and Splunk; and other data sources.</p>
</div>
<div class="sect3">
<h4 id="_panels">Panels</h4>
<div class="paragraph">
<p>The panel is the basic visualization building block in Grafana. Each panel has a Query Editor specific to the data source selected in the panel. The query editor allows you to extract the perfect visualization to display on the panel.</p>
</div>
<div class="paragraph">
<p>There are a wide variety of styling and formatting options for each panel. Panels can be dragged and dropped and rearranged on the Dashboard. They can also be resized.</p>
</div>
<div class="paragraph">
<p>Panels like the Graph panel allow you to graph as many metrics and series as you want. Other panels like Singlestat require a reduction of a single query into a single number.</p>
</div>
<div class="paragraph">
<p>Panels can be made more dynamic with Dashboard Templating variable strings within the panel configuration. The template can include queries to your data source configured in the Query Editor.</p>
</div>
<div class="paragraph">
<p>Panels can be shared easily in a variety of ways</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-3108c.png" alt="bg 3108c">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/123.gif" alt="meme">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dashboard">Dashboard</h4>
<div class="paragraph">
<p>A dashboard is a set of one or more panels organized and arranged into one or more rows. Grafana ships with a variety of Panels. Grafana makes it easy to construct the right queries, and customize the display properties so that you can create the perfect dashboard for your need. Each panel can interact with data from any configured Grafana Data Source (currently Graphite, Prometheus, Elasticsearch, InfluxDB, OpenTSDB, MySQL, PostgreSQL, Microsoft SQL Server and AWS Cloudwatch).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bg-974d8.png" alt="bg 974d8">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_data_source">Data Source</h4>
<div class="paragraph">
<p>Grafana can visualize, explore, and alert on data from many different databases and cloud services. Each database or service type is accessed from a data source. Before you can create visualizations in Grafana, you must add a data source.</p>
</div>
<div class="paragraph">
<p>Each data source has a specific query editor that is customized for the features and capabilities that the particular data source exposes. The query language and capabilities of each data source are obviously very different. You can combine data from multiple data sources into a single dashboard, but each panel is connected to a specific data source that belongs to a particular organization.</p>
</div>
<div class="paragraph">
<p>Use the query editor to build one or more queries in your time series database. The panel instantly updates, allowing you to effectively explore your data in real time and build a perfect query for that particular panel.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_git">git</h3>
<div class="imageblock">
<div class="content">
<img src="images/misc-24163.png" alt="misc 24163">
</div>
</div>
<div class="paragraph">
<p>Git (/t/) is a distributed version-control system for tracking changes in source code during software development. It is designed for coordinating work among programmers, but it can be used to track changes in any set of files. Its goals include speed, data integrity, and support for distributed, non-linear workflows.</p>
</div>
<div class="paragraph">
<p>This is one of the best tool in the field of programming, it eases collaboration and abstracts the complex task of version control.</p>
</div>
<div class="paragraph">
<p>Here our aim to understand the basics of git and get to use it for any projects in Bg.</p>
</div>
<div class="paragraph">
<p>To start with we refer to this <a href="https://www.atlassian.com/git/tutorials/atlassian-git-cheatsheet">cheatsheet</a> to learn the basics quickly and then understand the major
commands in details using further research.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-34f83.png" alt="misc 34f83">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-6a706.png" alt="misc 6a706">
</div>
</div>
<div class="paragraph">
<p>From this we further dwell into these major commands</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://www.atlassian.com/git/tutorials/saving-changes/git-commit">add/commit</a></p>
</li>
<li>
<p><a href="https://www.atlassian.com/git/tutorials/using-branches">branch</a></p>
</li>
<li>
<p><a href="https://www.atlassian.com/git/tutorials/using-branches/git-checkout">checkout</a></p>
</li>
<li>
<p><a href="https://www.atlassian.com/git/tutorials/syncing/git-pull">remote/fetch/pull/<em>push</em></a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The above links discuss in details</p>
</div>
<div class="sect3">
<h4 id="_addcommit">Add/commit</h4>
<div class="imageblock">
<div class="content">
<img src="images/misc-9d1c4.png" alt="misc 9d1c4">
</div>
</div>
<div class="paragraph">
<p>git add command is used to promote or 'stage' changes to the project that will be stored in a commit. These two commands git commit and git add are two of the most frequently used.</p>
</div>
<div class="paragraph">
<p>The git commit command captures a snapshot of the project&#8217;s currently staged changes. Committed snapshots can be thought of as safe versions of a projectGit will never change them unless you explicitly ask it to. This is in local.</p>
</div>
<div class="paragraph">
<p>At a high-level, Git can be thought of as a timeline management utility. Commits are the core building block units of a Git project timeline. Commits can be thought of as snapshots or milestones along the timeline of a Git project. Commits are created with the git commit command to capture the state of a project at that point in time. Git Snapshots are always committed to the local repository.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-1b9d3.png" alt="misc 1b9d3">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>git commit -m "commit message"</pre>
</div>
</div>
<div class="paragraph">
<p>This changes the basic development model for Git users. Instead of making a change and committing it directly to the central repo, Git developers have the opportunity to accumulate commits in their local repo. This has many advantages over SVN-style collaboration: it makes it easier to split up a feature into atomic commits, keep related commits grouped together, and clean up local history before publishing it to the central repository. It also lets developers work in an isolated environment, deferring integration until theyre at a convenient point to merge with other users. While isolation and deferred integration are individually beneficial, it is in a team&#8217;s best interest to integrate frequently and in small units.</p>
</div>
</div>
<div class="sect3">
<h4 id="_branch">Branch</h4>
<div class="paragraph">
<p>In Git, branches are a part of your everyday development process. Git branches are effectively a pointer to a snapshot of your changes. When you want to add a new feature or fix a bugno matter how big or how smallyou spawn a new branch to encapsulate your changes. This makes it harder for unstable code to get merged into the main code base, and it gives you the chance to clean up your future&#8217;s history before merging it into the main branch.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-3a14a.png" alt="misc 3a14a">
</div>
</div>
<div class="paragraph">
<p>The diagram above visualizes a repository with two isolated lines of development, one for a little feature, and one for a longer-running feature. By developing them in branches, its not only possible to work on both of them in parallel, but it also keeps the main master branch free from questionable code.</p>
</div>
<div class="paragraph">
<p>The implementation behind Git branches is much more lightweight than other version control system models. Instead of copying files from directory to directory, Git stores a branch as a reference to a commit. In this sense, a branch represents the tip of a series of commitsit&#8217;s not a container for commits. The history for a branch is extrapolated through the commit relationships.</p>
</div>
<div class="paragraph">
<p>List all branches</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git branch</pre>
</div>
</div>
<div class="paragraph">
<p>Create a new branch called &lt;branch&gt;, remember this does not checkout(jump to) the new branch</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git branch &lt;branch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s <strong>important</strong> to understand that branches are just pointers to commits. When you create a branch, all Git needs to do is create a new pointer, it doesnt change the repository in any other way. If you start with a repository that looks like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-43e09.png" alt="misc 43e09">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_checkout">Checkout</h4>
<div class="paragraph">
<p>A "checkout" is the act of switching between different versions of a target entity. The git checkout command operates upon three distinct entities: files, commits, and branches.</p>
</div>
<div class="paragraph">
<p>The git checkout command lets you navigate between the branches created by git branch. Checking out a branch updates the files in the working directory to match the version stored in that branch, and it tells Git to record all new commits on that branch. Think of it as a way to select which line of development youre working on.</p>
</div>
<div class="paragraph">
<p>Git checkout works hand-in-hand with git branch. The git branch command can be used to create a new branch. When you want to start a new feature, you create a new branch off master using git branch new_branch. Once created you can then use git checkout new_branch to switch to that branch. Additionally, The git checkout command accepts a -b argument that acts as a convenience method which will create the new branch and immediately switch to it. You can work on multiple features in a single repository by switching between them with git checkout.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git checkout -b &lt;new-branch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>By default git checkout -b will base the new-branch off the current <strong>HEAD</strong>.</p>
</div>
<div class="paragraph">
<p>Change branch or commit</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git checkout &lt;branchname&gt;</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Git Checkout a Remote Branch</div>
<div class="content">
<pre>git fetch --all
git checkout &lt;remotebranch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In modern versions of Git, you can then checkout the remote branch like a local branch.</p>
</div>
</div>
<div class="sect3">
<h4 id="_remotefetchpullpush">Remote/fetch/pull/push</h4>
<div class="imageblock">
<div class="content">
<img src="images/misc-defdb.png" alt="misc defdb">
</div>
</div>
<div class="paragraph">
<p>The git pull command is used to fetch and download content from a remote repository and immediately update the local repository to match that content. Merging remote upstream changes into your local repository is a common task in Git-based collaboration work flows. The git pull command is actually a combination of two other commands, git fetch followed by git merge. In the first stage of operation git pull will execute a git fetch scoped to the local branch that HEAD is pointed at. Once the content is downloaded, git pull will enter a merge workflow. A new merge commit will be-created and HEAD updated to point at the new commit.</p>
</div>
<div class="paragraph">
<p>git pull = git fetch + git merge [in local]</p>
</div>
<div class="sect4">
<h5 id="_working">Working</h5>
<div class="paragraph">
<p>The git pull command first runs git fetch which downloads content from the specified remote repository. Then a git merge is executed to merge the remote content refs and heads into a new local merge commit. To better demonstrate the pull and merging process let us consider the following example. Assume we have a repository with a master branch and a remote origin.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-1580d.png" alt="misc 1580d">
</div>
</div>
<div class="paragraph">
<p>In this scenario, git pull will download all the changes from the point where the local and master diverged. In this example, that point is E. git pull will fetch the diverged remote commits which are A-B-C. The pull process will then create a new local merge commit containing the content of the new diverged remote commits.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-00503.png" alt="misc 00503">
</div>
</div>
<div class="paragraph">
<p>In the above diagram, we can see the new commit H. This commit is a new merge commit that contains the contents of remote A-B-C commits and has a combined log message. This example is one of a few git pull merging strategies. A --rebase option can be passed to git pull to use a rebase merging strategy instead of a merge commit. The next example will demonstrate how a rebase pull works. Assume that we are at a starting point of our first diagram, and we have executed git pull --rebase.</p>
</div>
<div class="listingblock">
<div class="title">Rebase instead of merge</div>
<div class="content">
<pre>git pull --rebase</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-74d61.png" alt="misc 74d61">
</div>
</div>
<div class="paragraph">
<p>In this diagram, we can now see that a rebase pull does not create the new H commit. Instead, the rebase has copied the remote commits A&#8212;&#8203;B&#8212;&#8203;C and appended them to the local origin/master commit history.</p>
</div>
<div class="paragraph">
<p>Push is to update the commits to the distributed storage.</p>
</div>
<div class="listingblock">
<div class="title">Experiment</div>
<div class="content">
<pre>git clone git@gitlab.com:blugraph/bgsub.git

git config --global --edit

git branch

git checkout develop
git branch

git checkout -b asciiDocSplit

git branch
git log --graph

git add .

git commit -m "first commit without vim"


git push
fatal: The current branch asciiDocSplit has no upstream branch.
To push the current branch and set the remote as upstream, use

    git push --set-upstream origin asciiDocSplit</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regex">Regex</h3>
<div class="paragraph">
<p>This can be used in find in most code editor for easy search and replace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>\[([0-9])\]</pre>
</div>
</div>
<div class="paragraph">
<p>A regular expression, or regex for short, is a pattern describing a certain amount of text. On this website, regular expressions are highlighted in red as regex. This is actually a perfectly valid regex. It is the most basic pattern, simply matching the literal text regex. Matches are highlighted in blue on this site. We use the term string to indicate the text that the regular expression is applied to. Strings are highlighted in green.</p>
</div>
<div class="paragraph">
<p>Characters with special meanings in regular expressions are highlighted in various different colors. The regex (?x)([Rr]egexp?)\? shows meta tokens in purple, grouping in green, character classes in orange, quantifiers and other special tokens in blue, and escaped characters in gray.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-b9de2.png" alt="misc b9de2">
</div>
</div>
<div class="sect3">
<h4 id="_basic_topics">Basic topics</h4>
<div class="sect4">
<h5 id="_anchors_and">Anchors  ^ and $</h5>
<div class="listingblock">
<div class="content">
<pre>^The        matches any string that starts with The
end$        matches a string that ends with end
^The end$   exact string match (starts and ends with The end)
roar        matches any string that has the text roar in it</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_quantifiers_and">Quantifiers  * + ? and {}</h5>
<div class="listingblock">
<div class="content">
<pre>abc*        matches a string that has ab followed by zero or more c
abc+        matches a string that has ab followed by one or more c
abc?        matches a string that has ab followed by zero or one c
abc{2}      matches a string that has ab followed by 2 c
abc{2,}     matches a string that has ab followed by 2 or more c
abc{2,5}    matches a string that has ab followed by 2 up to 5 c
a(bc)*      matches a string that has a followed by zero or more copies of the sequence bc
a(bc){2,5}  matches a string that has a followed by 2 up to 5 copies of the sequence bc</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_or_operator_or">OR operator  | or []</h5>
<div class="listingblock">
<div class="content">
<pre>a(b|c)     matches a string that has a followed by b or c (and captures b or c)
a[bc]      same as previous, but without capturing b or c</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_character_classes_d_w_s_and">Character classes  \d \w \s and .</h5>
<div class="listingblock">
<div class="content">
<pre>\d         matches a single character that is a digit
\w         matches a word character (alphanumeric character plus underscore)
\s         matches a whitespace character (includes tabs and line breaks)
.          matches any character</pre>
</div>
</div>
<div class="paragraph">
<p>Use the . operator carefully since often class or negated character class (which well cover next) are faster and more precise.
\d, \w and \s also present their negations with \D, \W and \S respectively.</p>
</div>
<div class="paragraph">
<p>For example, \D will perform the inverse match with respect to that obtained with \d.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>\D         matches a single non-digit character</pre>
</div>
</div>
<div class="paragraph">
<p>In order to be taken literally, you must escape the characters ^.[$()|*+?{\with a backslash \ as they have special meaning.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>\$\d       matches a string that has a $ before one digit</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that you can match also non-printable characters like tabs \t, new-lines \n, carriage returns \r.</p>
</div>
</div>
<div class="sect4">
<h5 id="_flags">Flags</h5>
<div class="paragraph">
<p>We are learning how to construct a regex but forgetting a fundamental concept: flags.</p>
</div>
<div class="paragraph">
<p>A regex usually comes within this form /abc/, where the search pattern is delimited by two slash characters /. At the end we can specify a flag with these values (we can also combine them each other):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>g (global) does not return after the first match, restarting the subsequent searches from the end of the previous match</p>
</li>
<li>
<p>m (multi-line) when enabled ^ and $ will match the start and end of a line, instead of the whole string</p>
</li>
<li>
<p>i (insensitive) makes the whole expression case-insensitive (for instance /aBc/i would match AbC)</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_intermediate_topics">Intermediate topics</h5>
<div class="sect5">
<h6 id="_grouping_and_capturing">Grouping and capturing  ()</h6>
<div class="listingblock">
<div class="content">
<pre>a(bc)           parentheses create a capturing group with value bc
a(?:bc)*        using ?: we disable the capturing group
a(?&lt;foo&gt;bc)     using ?&lt;foo&gt; we put a name to the group
This operator is very useful when we need to extract information from strings or data using your preferred programming language. Any multiple occurrences captured by several groups will be exposed in the form of a classical array: we will access their values specifying using an index on the result of the match.
If we choose to put a name to the groups (using (?&lt;foo&gt;...)) we will be able to retrieve the group values using the match result like a dictionary where the keys will be the name of each group.</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_bracket_expressions">Bracket expressions[]</h6>
<div class="listingblock">
<div class="content">
<pre>[abc]            matches a string that has either an a or a b or a c -&gt; is the same as a|b|c
[a-c]            same as previous
[a-fA-F0-9]      a string that represents a single hexadecimal digit, case insensitively
[0-9]%           a string that has a character from 0 to 9 before a % sign
[^a-zA-Z]        a string that has not a letter from a to z or from A to Z. In this case the ^ is used as negation of the expression</pre>
</div>
</div>
<div class="paragraph">
<p>Remember that inside bracket expressions all special characters (including the backslash \) lose their special powers: thus we will not apply the escape rule.</p>
</div>
</div>
<div class="sect5">
<h6 id="_greedy_and_lazy_match">Greedy and Lazy match</h6>
<div class="paragraph">
<p>The quantifiers ( * + {}) are greedy operators, so they expand the match as far as they can through the provided text.
For example, &lt;.&gt; matches &lt;div&gt;simple div&lt;/div&gt; in This is a &lt;div&gt; simple div&lt;/div&gt; test. In order to catch only the div tag we can use a ? to make it lazy:
&lt;.?&gt;            matches any character one or more times included inside &lt; and &gt;, expanding as needed
Notice that a better solution should avoid the usage of . in favor of a more strict regex:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;[^&lt;&gt;]+&gt;         matches any character except &lt; or &gt; one or more times included inside &lt; and &gt;</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_http23">HTTP2/3</h3>
<div class="paragraph">
<p><a href="https://medium.com/devgorilla/what-is-http-3-94335c57823f">HTTP3</a></p>
</div>
<div class="paragraph">
<p><a href="https://medium.com/@Grigorkh/why-we-need-to-use-http-2-in-2017-e9e38d95a5e5">Why HTTP2 in 2017</a></p>
</div>
<div class="paragraph">
<p><a href="https://medium.com/faun/http-and-everything-you-need-to-know-about-it-8273bc224491">All about HTTP</a></p>
</div>
<div class="paragraph">
<p><a href="https://aboullaite.me/http-rest-apis/">HTTP API vs REST API</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>pandoc --wrap=none -f html -t asciidoc myfile.html &gt; myfile.adoc</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>^\[\[[a-zA-Z0-9]*\]\] - Regex for removing [[alphNum]] - ^-starting, [a-zA-Z0-9] - any digit, *- for multiple such characters</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_is_http">What is HTTP ?</h3>
<div class="paragraph">
<p>HTTP stands for Hypertext Transfer Protocol, and HTTP is the communication protocol used for browsing the web. This protocol uses a message based model where your client makes an HTTP request to a web server and that server responds with a resource which is displayed in the browser.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Every HTTP interaction includes a request and a response. By its nature, HTTP is stateless.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Stateless</strong> means that all requests are separate from each other so every request must contain enough information on their own to fulfill the request. That means that each transaction of message based model of HTTP is processed separately from each other.</p>
</div>
<div class="sect3">
<h4 id="_url">URL</h4>
<div class="paragraph">
<p>The URL (Uniform Resource Locator) is probably the most known concept of the Web. It is also one of most important and useful concepts. URL is a web address used to identify resources on the Web.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The idea of the web is structured around the resources, from its beginnings the Web was the platform for sharing text/HTML files, documents, images etc, and as such it can be considered a collection of resources.</p>
</div>
</blockquote>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-be39c.png" alt="misc be39c">
</div>
</div>
<div class="paragraph">
<p><strong>Protocol</strong>  Most often they are HTTP (or HTTPS for a secure version of HTTP).</p>
</div>
<div class="paragraph">
<p>Other notable protocols are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="a6fd">File Transfer Protocol (FTP)  is a standard <a href="https://en.wikipedia.org/wiki/Network_protocol" class="bare">https://en.wikipedia.org/wiki/Network_protocol</a> protocol used for transfering of <a href="https://en.wikipedia.org/wiki/Computer_file" class="bare">https://en.wikipedia.org/wiki/Computer_file</a> files between a client and a server over a network.</span></p>
</li>
<li>
<p><span id="a929">Simple Mail Transfer Protocol (SMTP) is an standard for email transmission.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Domain</strong>  Name that is used to identify one or more IP addresses where the resource is located.</p>
</div>
<div class="paragraph">
<p><strong>Path</strong> Specifies the resource location on the server. It uses the same logic as a resource location used on the device you are reading this article (i.e. /search/cars/VWBeetle.pdf or C:/my cars/VWBeetle.pdf).</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong>  Additional data used to identify or filter the resource on the server.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>NOTE</strong></p>
</div>
<div class="paragraph">
<p>When searching for articles and more information about HTTP you may encounter the term URI (or uniform resource identifier). URI is sometimes being used instead of URL but mostly in formal specifications and by people who want to show off :)</p>
</div>
</blockquote>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_http_requests"><strong>HTTP Requests</strong></h4>
<div class="paragraph">
<p>In HTTP, every request must have an URL address. Additionally, request needs a method. The four main HTTP methods are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="45aa">GET</span></p>
</li>
<li>
<p><span id="b1cb">PUT</span></p>
</li>
<li>
<p><span id="037e">POST</span></p>
</li>
<li>
<p><span id="1b02">DELETE</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I will explain these methods, and more, in HTTP Methods section of this article.</p>
</div>
<div class="paragraph">
<p>And these methods directly correspond to actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="3ca7">read</span></p>
</li>
<li>
<p><span id="f18c">update</span></p>
</li>
<li>
<p><span id="ece6">create</span></p>
</li>
<li>
<p><span id="a38b">delete</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All HTTP messages have one or more headers, followed by a optional message body. The body contains the data that will be sent with the request or the data received with the response.</p>
</div>
<div class="paragraph">
<p>First part of every HTTP request holds three items:</p>
</div>
<div class="paragraph">
<p><em>Example:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="d29c"><em>GET /adds/search-result?item=vw+beetle HTTP/1.1</em></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>When a URL contains a ? sign means it contains a query. That means it sends parameters of the requested resource.</em></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><span id="e128">First part is a method which tells which HTTP method is used. Most commonly used is the GET method. GET method retrieves a resource from the web server and since GET doesnt have a message body nothing after the header is needed.</span></p>
</li>
<li>
<p><span id="43be">Second part is a requested URL.</span></p>
</li>
<li>
<p><span id="36e6">Third part is a HTTP version being used. Version 1.1. is the most common version for most browsers, however, version 2.0 is taking over.</span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are also some other interesting things in a HTTP request:</p>
</div>
<div class="paragraph">
<p><strong>Referer header</strong>  tell the URL from which the request has originated.</p>
</div>
<div class="paragraph">
<p><strong>User-Agent header</strong>  additional information about the browser being used to generate the request.</p>
</div>
<div class="paragraph">
<p><strong>Host header</strong>  uniquely identify a host name, it is necessary when multiple web pages are hosted on the same server.</p>
</div>
<div class="paragraph">
<p><strong>Cookie header</strong>  submit additional parameters to the client.</p>
</div>
</div>
<div class="sect3">
<h4 id="_http_responses"><strong>HTTP Responses</strong></h4>
<div class="paragraph">
<p>Just like in HTTP requests HTTP responses also consist of three items:</p>
</div>
<div class="paragraph">
<p><em>Example:</em></p>
</div>
<div class="paragraph">
<p><em>HTTP/1.1 200 OK</em></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><span id="3d2d">First part is the HTTP version being used.</span></p>
</li>
<li>
<p><span id="9843">Second part is the numeric code of the result for the request.</span></p>
</li>
<li>
<p><span id="fce8">Third part is a textual description of the second part.</span></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are some other interesting things in a HTTP response:</p>
</div>
<div class="paragraph">
<p><strong>Server header</strong>  information which web server software is being used.</p>
</div>
<div class="paragraph">
<p><strong>Set-Cookie header</strong>  issues the cookie to the browser.</p>
</div>
<div class="paragraph">
<p><strong>Message body</strong>  it is common for a HTTP response to hold a message body.</p>
</div>
<div class="paragraph">
<p><strong>Content-Length header</strong>  tells the size of the message body in bytes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_http_methods">HTTP Methods</h4>
<div class="paragraph">
<p>Most common methods are GET and POST, however there are more of them.</p>
</div>
<div class="paragraph">
<p><strong>GET</strong>  used to request data from a specified resource where data is not modified it in any way as GET requests do not change the state of resource.</p>
</div>
<div class="paragraph">
<p><strong>POST</strong>  used to send data to a server to create a resource.</p>
</div>
<div class="paragraph">
<p><strong>PUT </strong> method to update existing resource on a server by using the content in body of the request.</p>
</div>
<div class="paragraph">
<p><strong>HEAD</strong>  this method has the same function as GET method but with a difference that the return of a HEAD method should not contain body in the response. However, the return will contain same headers as if GET was used. HEAD method is used to check if the resource is present prior of making a GET request.</p>
</div>
<div class="paragraph">
<p><strong>TRACE </strong> method designed for diagnostic purposes. Response will contain in its body the exact content of the request message.</p>
</div>
<div class="paragraph">
<p><strong>OPTIONS</strong>  this ** method is used to describe the communication options (HTTP methods) that are available for the target resource.</p>
</div>
<div class="paragraph">
<p><strong>PATCH </strong> The PATCH method is used to apply partial modifications to a resource.</p>
</div>
<div class="paragraph">
<p><strong>DELETE </strong> The DELETE method deletes the specified resource.</p>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_http_headers"><strong>HTTP Headers</strong></h4>
<div class="paragraph">
<p>There are three main components that make up the request/response structure. This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="7adc">First line</span></p>
</li>
<li>
<p><span id="dea6">Headers</span></p>
</li>
<li>
<p><span id="5b14">Body/Content</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We already talked about the first line in HTTP requests and responses, body function was mentioned and now we will talk about HTTP headers.</p>
</div>
<div class="paragraph">
<p>The HTTP headers are added after the First line and are defined as name: value pairs separated by a colon. HTTP headers are used to send additional parameters along with the request or response.</p>
</div>
<div class="paragraph">
<p>As we already said, the body of the message includes the data to be sent with the request or the data received along with the response.</p>
</div>
<div class="paragraph">
<p>There are different types of headers we group based on their usage into 4 broad categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="cbec"><strong>General header</strong>  Headers that can be used in both requests and response messages and that are independent of the data being exchanged.</span></p>
</li>
<li>
<p><span id="d159"><strong>Request header</strong>  These headers define parameters for the data requested or parameters that give important information about the client making the request.</span></p>
</li>
<li>
<p><span id="ba74"><strong>Response header</strong>  These headers contain information about the incoming response.</span></p>
</li>
<li>
<p><span id="5a69"><strong>Entity header</strong>  The entity headers describe the content that makes up the body of the message.</span></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-732ec.png" alt="misc 732ec">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_http_status_codes"><strong>HTTP status codes</strong></h4>
<div class="paragraph">
<p>Every HTTP response message must contain a HTTP status code in its first line, telling us the result of the request.</p>
</div>
<div class="paragraph">
<p>There are five groups of status codes which are grouped by the first digit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="41a1">1xx  Informational.</span></p>
</li>
<li>
<p><span id="93ef">2xx  The request was successful.</span></p>
</li>
<li>
<p><span id="0408">3xx  The client is redirected to a different resource.</span></p>
</li>
<li>
<p><span id="b1c3">4xx  The request contains an error of some kind.</span></p>
</li>
<li>
<p><span id="9b74">5xx  The server encountered an error fulfilling the request.</span></p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Full list of HTTP Status Response Codes and their explanation: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" class="bare">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status</a></p>
</div>
</blockquote>
</div>
</div>
<div class="sect3">
<h4 id="_https_hypertext_transfer_protocol_secure">HTTPS (Hypertext Transfer Protocol Secure)</h4>
<div class="paragraph">
<p>Secure version of HTTP protocol is HyperText Transfer Protocol Secure (HTTPS). HTTPS provides encrypted communication between a browser (client) and the website (server).</p>
</div>
<div class="paragraph">
<p>In HTTPS, the communication protocol is encrypted using Transport Layer Security (TLS) or Secure Sockets Layer (SSL).</p>
</div>
<div class="paragraph">
<p>Protocol is therefore also often called as HTTP over TLS, or HTTP over SSL.</p>
</div>
<div class="paragraph">
<p>Both the TLS and SSL protocols use an asymmetric encryption system. Asymmetric encryption system uses a public key (encryption key) and a private key (decryption keys) to encrypt a message. Anyone can use the public key to encrypt a message. However, private keys are secret, and that means that only the intended receiver can decrypt the message.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-aa839.png" alt="misc aa839">
</div>
</div>
<div class="sect4">
<h5 id="_ssltls_handshake">SSL/TLS handshake</h5>
<div class="paragraph">
<p>When you request a HTTPS connection to a website, the website sends its SSL certificate to your browser. That proces where your browser and website initiate communication is called the SSL/TLS handshake. The SSL/TLS handshake involves a series of steps where browser and website validate each other and start communication through the SSL/TLS tunnel.</p>
</div>
<div class="paragraph">
<p>As you probably noticed, when a trusted secure tunnel is used during in a HTTPS connection, the green padlock icon is displayed in the browsers address bar.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-8ea22.png" alt="misc 8ea22">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_benefits_of_https"><strong>Benefits of HTTPS</strong></h4>
<div class="paragraph">
<p>The major benefits of a HTTPS are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="f331">Customer information, like credit card numbers and other sensitive information, is encrypted and cannot be intercepted.</span></p>
</li>
<li>
<p><span id="a42a">Visitors can verify you are a registered business and that you own the domain.</span></p>
</li>
<li>
<p><span id="df8d">Customers know they are not suppose to visit sites without HTTPS, and therefore, they are more likely to trust and complete purchases from sites that use HTTPS.</span></p>
</li>
</ul>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_rest"><strong>REST</strong></h4>
<div class="paragraph">
<p>Representational state transfer (REST) is a architecture style where request and responses contain representation of the current state of the systems resource.</p>
</div>
<div class="paragraph">
<p><em>Normal way:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="e5cd"><a href="http://carapp.com/search?make=wv&amp;model=beetle"><em>http://carapp.com/search?make=wv&amp;model=beetle</em></a></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>REST-style:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="e785"><a href="http://carapp.com/search/vw/beetle"><em>http://carapp.com/search/vw/beetle</em></a></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ill be talking more about REST APIs in my other article so please feel free to check it out.</p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="_rest_api">REST API</h3>
<div class="paragraph">
<p>REST is a design style for protocols, it was developed by Roy Fielding in his <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">PhD dissertation</a> and formalised the approach behind HTTP/1.0, finding what worked well with it, and then using this more structured understanding of it to influence the design of HTTP/1.1. So, while it was after-the-fact in a lot of ways, REST is the design style behind HTTP.</p>
</div>
<div class="paragraph">
<p>A RESTful system would obtain information about the resources concerned by GETting URI which would then return a document (e.g. in JSON, but not necessarily) which would describe the state of the resource, including URIs to related resources (hypermedia therefore), change their state through PUTting entities describing the new state or DELETEing them, and have other actions performed by POSTing.</p>
</div>
<div class="paragraph">
<p>Thus the following HTTP requests all have different meanings when using REST:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GET /api/customers</p>
</li>
<li>
<p>POST /api/customers</p>
</li>
<li>
<p>PUT /api/customers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are only a few HTTP request methods. The full list is <code>CONNECT</code>, <code>DELETE</code>, <code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code>, <code>PATCH</code>, <code>POST</code>, <code>PUT</code>, and <code>TRACE</code>. You may be forgiven if youve never heard of a few of these, as some are almost never supported by client or server software.</p>
</div>
<div class="paragraph">
<p>Roy also advocated that HTTP response codes he helped define be used to communicate the meaning of the response. There are ~38 HTTP response codes. Below is a complete list:<br></p>
</div>
<div class="paragraph">
<p>Designing RESTful application is usually a lot harder because it requires you to describe complicated things in a simple manner. describing all functionalities using only CRUD functions is tricky, but after doing that your life would be a lot simpler and you will find that you will write a lot shorter methods.</p>
</div>
<div class="paragraph">
<p>The classic example of a non-RESTful system using HTTP is something which treats HTTP as if it was a transport protocol, and with every request sends a POST of data to the same URI which is then acted upon in an RPC-like manner, possibly with the connection itself having shared state.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the following example:</p>
</div>
<div class="sect3">
<h4 id="_request">Request</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-codeblock" data-lang="codeblock">GET api/customers/10
1</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_response">Response</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-codeblock" data-lang="codeblock">            {
           "customer":{
              "id":"10",
              "name": "customer name",
              "age": "28"
           }
        }
1234567</code></pre>
</div>
</div>
<div class="paragraph">
<p>While such APIs have borrowed some of the REST principles, such as identifying each resource by an ID, accessing resources via hyperlinks, providing multiple representations for resources (JSON, XML)  they do not abide to all REST principles, applying the so called pragmatic REST, resulting in multiple interpretations of REST. Fielding <a href="http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven">expressed his frustration</a> with RESTful API implementations years ago, informing API designers that several rules need to be followed for an API to be called RESTful.</p>
</div>
<div class="paragraph">
<p>Long story short, there is a big difference between a RESTful API and a HTTP API. A RESTful API adheres ALL the REST constraints set out in its "format" documentation (in the dissertation of Roy Fielding). A HTTP API is ANY API that makes use of HTTP as their transfer protocol. This means that even SOAP can be considered a HTTP API, as long as it will use HTTP for transport, but most HTTP APIs will make more and better use of the infrastructure and possibilities of HTTP. Most HTTP APIs can be very close to becoming a truly RESTful API. This can be defined by their <a href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richardsons maturity level</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
REST is a specific way of approaching the design of big systems (like the web).
   It&#8217;s a set of 'rules' (or 'constraints').
HTTP is a protocol that tries to obey those rules.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>REST</strong> = Representational State Transfer</p>
</div>
<div class="paragraph">
<p>REST is a set of rules, that when followed, enable you to build a distributed application that has a specific set of desirable constraints.</p>
</div>
<div class="paragraph">
<p>REST is a protocol to exchange any(XML, JSON etc ) messages that can use HTTP to transport those messages.</p>
</div>
<div class="paragraph">
<p><strong>Features:</strong></p>
</div>
<div class="paragraph">
<p>It is stateless which means that ideally no connection should be maintained between the client and server. It is the responsibility of the client to pass its context to the server and then the server can store this context to process the client&#8217;s further request. For example, session maintained by server is identified by session identifier passed by the client.</p>
</div>
<div class="paragraph">
<p><strong>Advantages of Statelessness:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Web Services can treat each method calls separately.</p>
</li>
<li>
<p>Web Services need not maintain the client&#8217;s previous interaction.</p>
</li>
<li>
<p>This in turn simplifies application design.</p>
</li>
<li>
<p>HTTP is itself a stateless protocol unlike TCP and thus RESTful Web Services work seamlessly with the HTTP protocols.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_why_http_2">Why HTTP 2</h3>
<div class="paragraph">
<p>HTTP/2 is the first major upgrade to the HTTP protocol in over 15 years. Websites have changed dramatically in the interim, with the number of external image, CSS, and JavaScript assets growing by the year. HTTP/1.1 wasnt designed for this kind of complexity. HTTP/2 is optimized for the modern website, improving performance without complicated hacks like domain sharding and file concatenation.<br>
Adopting HTTP/2 speeds up your website without any changes to your existing codebase.</p>
</div>
<div class="sect3">
<h4 id="_test_results">Test results</h4>
<div class="paragraph">
<p>HTTP/2 demonstrated to be consistently faster then HTTP/1.1 on this test</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="2ee7">4 times faster on WiFi / 20Mbps cable, average server ping 50ms</span></p>
</li>
<li>
<p><span id="fa04">6 times faster on LTE network, average server ping 90ms</span></p>
</li>
<li>
<p><span id="43a7">15 times faster on 3G network, average server ping 120ms</span></p>
</li>
<li>
<p><span id="2934">2 times faster on 2G network, average server ping 400ms</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reason HTTP/2 is just 2x faster on 2G network is due to EDGE bandwidth constraints as at 170Kbps link rapidly saturates.</p>
</div>
<div class="paragraph">
<p>The primary goals for HTTP/2 are to reduce latency by enabling full request and response multiplexing, minimize protocol overhead via efficient compression of HTTP header fields, and add support for request prioritization and server push. To implement these requirements, there is a large supporting cast of other protocol enhancements, such as new flow control, error handling, and upgrade mechanisms, but these are the most important features that every web developer should understand and leverage in their applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-97120.png" alt="misc 97120">
</div>
</div>
<div class="paragraph">
<p>HTTP/2 does not modify the application semantics of HTTP in any way. All the core concepts, such as HTTP methods, status codes, URIs, and header fields, remain in place. Instead, HTTP/2 modifies how the data is formatted (framed) and transported between the client and server, both of whom manage the entire process, and hides all the complexity from our applications within the new framing layer. As a result, all existing applications can be delivered without modification.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Why not HTTP/1.2?</em></p>
</div>
<div class="paragraph">
<p><em>To achieve the performance goals set by the HTTP Working Group, HTTP/2 introduces a new binary framing layer that is not backward compatible with previous HTTP/1.x servers and clients  hence the major protocol version increment to HTTP/2.</em></p>
</div>
<div class="paragraph">
<p><em>That said, unless you are implementing a web server (or a custom client) by working with raw TCP sockets, then you wont see any difference: all the new, low-level framing is performed by the client and server on your behalf. The only observable differences will be improved performance and availability of new capabilities like request prioritization, flow control, and server push!</em></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>HTTP/2 defines request priorities and supports cancellations, so that if an application needs to render i.e. a dynamic gallery preview it can request high priority images for the initial view, request images down the list and i.e. cancel their download if user would navigate away or scroll deep down the list.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timeline">Timeline</h4>
<div class="ulist">
<ul>
<li>
<p><span id="eccf">March 2012: Call for proposals for HTTP/2</span></p>
</li>
<li>
<p><span id="3526">November 2012: First draft of HTTP/2 <strong>(based on SPDY)</span></strong> - developed by <strong>Google</strong></p>
</li>
<li>
<p><span id="8dbd">August 2014: HTTP/2 draft-17 and HPACK draft-12 are published</span></p>
</li>
<li>
<p><span id="83ec">August 2014: Working Group last call for HTTP/2</span></p>
</li>
<li>
<p><span id="df6d">February 2015: IESG approved HTTP/2 and HPACK drafts</span></p>
</li>
<li>
<p><span id="2668">May 2015: RFC 7540 (HTTP/2) and RFC 7541 (HPACK) are published</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_why_http_3_what_is_it">Why HTTP 3 &amp; what is it</h3>
<div class="imageblock">
<div class="content">
<img src="images/http3.gif" alt="meme">
</div>
</div>
<div class="paragraph">
<p>The HTTP-over-QUIC experimental protocol should be renamed to HTTP/3, officials at the (IETF) have disclosed.</p>
</div>
<div class="paragraph">
<p>There is a big gap in development from HTTP/1.1 (released in 1999) to the release of <a href="https://medium.com/@Grigorkh/why-we-need-to-use-http-2-in-2017-e9e38d95a5e5">HTTP/2</a> (released in 2015), things are hitting up with the release of HTTP/3 due in 2019.</p>
</div>
<div class="paragraph">
<p>HTTP/3 is an evolution of the QUIC protocol from Google. Its started from this <a href="https://mailarchive.ietf.org/arch/msg/quic/RLRs4nB1lwFCZ_7k0iuz0ZBa35s">suggestion</a> by Mark Nottingham.</p>
</div>
<div class="sect3">
<h4 id="_so_what_is_quic">So what is QUIC?</h4>
<div class="paragraph">
<p>QUIC ( Quick UDP Internet Connections) is a new transport which reduces latency compared to that of TCP. On the surface, QUIC is very similar to TCP+TLS+HTTP/2 implemented on UDP. Because TCP is implemented in operating system kernels, and middlebox firmware, making significant changes to TCP is next to impossible. However, since QUIC is built on top of UDP, it suffers from no such limitations.</p>
</div>
<div class="paragraph">
<p><strong>Key features of QUIC over existing TCP+TLS+HTTP2 include</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><span id="427c">Dramatically reduced connection establishment time</span></p>
</li>
<li>
<p><span id="4818">Improved congestion control</span></p>
</li>
<li>
<p><span id="0ae0">Multiplexing without head of line blocking</span></p>
</li>
<li>
<p><span id="a5f0">Forward error correction</span></p>
</li>
<li>
<p><span id="44d3">Connection migration</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Google <a href="https://blog.chromium.org/2015/04/a-quic-update-on-googles-experimental.html">says</a> that roughly half of all requests from Chrome to Google servers are served over QUIC and they are continuing to ramp up QUIC traffic, eventually making it the default transport from Google clients  both Chrome and mobile apps  to Google servers. They plan to formally propose QUIC to the IETF as an Internet standard but they have some housekeeping to do first, like changing the wire format and updating their reference implementation from SPDY-over-QUIC to HTTP2-over-QUIC (current <a href="https://tools.ietf.org/html/draft-ietf-quic-http-16#page-4">HTTP-over-QUIC protocol draft</a> uses the newly released TLS 1.3 protocol). In the coming months, Google also plans to work on lowering handshake overhead to allow better server-side scalability, improving forward error correction and congestion control, and adding support for multipath connections.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/http3s.gif" alt="meme">
</div>
</div>
<div class="paragraph">
<p>Great explanation of TCP vs QUIC by <a href="https://www.reddit.com/user/AyrA_ch">reddit user</a>:</p>
</div>
<div class="paragraph">
<p>TCP was developed when we still were transmitting packets over networks that had much larger packet loss than we do today and computer systems had much longer to answer TCP messages. The timeout for connecting to a host for example is still 20 seconds even though you are very unlikely to ever get an answer if the TCP handshake alone cant even be completed within 5 seconds. These long delays are reasons why networked applications sometimes get stuck for a long time. We havent touched these delays since the protocol was invented in the 70s even though we saw massive improvements on reliability and speed.</p>
</div>
<div class="paragraph">
<p>Instead of finally reducing these defaults which would not alter the packets and is largely compatible with the current TCP implementations, protocol developers just started using UDP and then implement their own TCP on top of it. The transition to IPv6 would have been the ideal time to also update TCP to a version that fixes most of the issues it has, mostly timeouts, window size and TCP slow start. Some of the values can be tweaked in your OS, but the timeout, which is one of the most annoying cant. If you kill a TCP socket that hangs for 5 seconds, your OS will still leave it open until the 20 seconds expired, consuming system resources.</p>
</div>
</div>
<div class="sect3">
<h4 id="_crontab_based_timlapse_for_rtsp_2">Crontab based Timlapse for RTSP</h4>
<div class="paragraph">
<p>Crontab log</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grep CRON /var/log/syslog</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://www.thegeekdiary.com/cron-script-does-not-execute-as-expected-from-crontab-troubleshoot/">Important</a></p>
</div>
<div class="paragraph">
<p>For any shell commands please include these lines</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash
. /home/oracle/.bashrc</pre>
</div>
</div>
<div class="paragraph">
<p>And for logging</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* * * * * /home/oracle/script.sh 2&gt; /tmp/crontab_script_log.txt 2&gt;&amp;1</pre>
</div>
</div>
<div class="paragraph">
<p>Make sure variables don&#8217;t have -</p>
</div>
<div class="paragraph">
<p>RTSPSTREAM doesnt have any - in between</p>
</div>
<div class="paragraph">
<p>Capture</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash
. /home/oracle/.bashrc
source /root/timelapse/config.txt

ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-00.jpg"
sleep 13
ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-15.jpg"
sleep 13
ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-30.jpg"
sleep 13
ffmpeg -y -i $RTSPSTREAM -vframes 1 -strftime 1 "$TIMELAPSERAWPATH/%Y-%m-%d_%H-%M-45.jpg"</pre>
</div>
</div>
<div class="paragraph">
<p>Compile to MP4</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/bash
. /home/oracle/.bashrc
source /root/timelapse/config.txt

date="$(date "+%m_%d_%Y")"
date2="$(date "+%m-%d-%y")"
ffmpeg -f image2 -i $TIMELAPSERAWPATH/%*.jpg -vcodec libx264 -r 60 -strftime 1 $TIMELAPSESOUTPUTPATH/"${date}".mp4 -y
rm $TIMELAPSERAWPATH/*</pre>
</div>
</div>
<div class="paragraph">
<p>Cron</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* * * * *  /root/timelapse/timelapse-capture.sh
55 23 * * * /root/timelapse/timelapse-capture.sh</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo service cron reload</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_storing_cloud_ip_address_as_system_variables">Storing Cloud ip address as System variables</h4>
<div class="paragraph">
<p>~/.bash_profile can be used to do this</p>
</div>
<div class="listingblock">
<div class="title">Export</div>
<div class="content">
<pre>#export email = "128.199.96.150"
export email="128.199.96.150"</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">CAUTION</dt>
<dd>
<p>Do not add space between =
The first  line throws an erorr !!</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Source</div>
<div class="content">
<pre>source ~/.bash_profile</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Login</div>
<div class="content">
<pre>ssh root@$email</pre>
</div>
</div>
<div class="paragraph">
<p>Dont forget the $</p>
</div>
</div>
<div class="sect3">
<h4 id="_timezone_setting">Timezone setting</h4>
<div class="listingblock">
<div class="content">
<pre>sudo dpkg-reconfigure tzdata
timedatectl
hwclock</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_django_app_on_ubuntu_server">Creating a Django App on Ubuntu Server</h4>
<div class="paragraph">
<p>Django is a common platform for developing websites, web applications and web APIs. There are many advantages to using the Django framework for your project as your tool and if youre not sure its the right fit, you need only to look to the many big name brands using Django in their stack.
Deploying Django to a production environment for the first time can be a daunting task. Often, developers will launch a Linux instance on the cloud for their production environment.</p>
</div>
<div class="paragraph">
<p>In this tutorial, well show you how to launch Django in production, using a fresh Ubuntu instance.</p>
</div>
<div class="paragraph">
<p>Well assume that all of your editing is done on the server, and that youre running the commands as root.</p>
</div>
<div class="paragraph">
<p>For this tutorial, were using Ubuntu 18.04.2 LTS</p>
</div>
<div class="sect4">
<h5 id="_creating_a_user_for_the_project">Creating a user for the project</h5>
<div class="paragraph">
<p>Creating a user for the project
To create the new user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>useradd -m django</pre>
</div>
</div>
<div class="paragraph">
<p>The -m flag creates a new home directory: /home/django.</p>
</div>
</div>
<div class="sect4">
<h5 id="_setting_up_the_django_project">Setting up the Django project</h5>
<div class="paragraph">
<div class="title">Setup a Virtualenv for added security and dependency issues</div>
<p>For this tutorial, well create a temporary Django project. If youre deploying your own code, youll have to upload it to the server instead. Well be operating in the home directory, /home/django.Setting up the Django project
Lets create the Django project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd /home/django
source env/bin/activate
pip install django
django-admin startproject tutorial</pre>
</div>
</div>
<div class="paragraph">
<p>Verify things are working by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd tutorial
python manage.py runserver 0.0.0.0:80</pre>
</div>
</div>
<div class="paragraph">
<p>Our Ubuntu instance is running at 178.128.229.34 so well connect to <a href="http://178.128.229.34.Verify" class="bare">http://178.128.229.34.Verify</a> things are working by running:
To fix this, well edit /home/django/tutorial/tutorial/settings.py. Find  ALLOWED_HOSTS = [] and set it to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ALLOWED_HOSTS = [
'178.128.229.34' # replace this with your server's IP address
 or the domain name you're using to connect
]</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_setting_up_nginx_the_web_server"><strong>Setting up nginx, the web server</strong></h5>
<div class="paragraph">
<p>When you run</p>
</div>
<div class="listingblock">
<div class="content">
<pre>python manage.py runserver</pre>
</div>
</div>
<div class="paragraph">
<p>, <strong>youre using Djangos development server</strong>. This is great for local development, but as with SQLite3, its not really suited for production.</p>
</div>
<div class="paragraph">
<p>Common choices for production web servers are nginx and Apache. For this tutorial, we will use nginx.</p>
</div>
<div class="paragraph">
<p>Install nginx using the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>apt-get install nginx</pre>
</div>
</div>
<div class="paragraph">
<p>Now, if everything has worked well, nginx should be running on port 80. Go ahead and check out you website; you should see:</p>
</div>
<div class="paragraph">
<p>Great, so nginx is up and running! Next well need to configure it to communicate with Django. Open up the nginx configuration file, located at /etc/nginx/sites-available/default. Lets replace the file with the following:</p>
</div>
<div class="listingblock">
<div class="title">/etc/nginx/sites-available/default</div>
<div class="content">
<pre>upstream django {
server 127.0.0.1:8000;
}

server {
listen 80;

location / {
try_files $uri @send_to_django;
}

location @send_to_django {
proxy_set_header Host $http_host;
proxy_redirect off;
proxy_pass http://django;
}
}</pre>
</div>
</div>
<div class="paragraph">
<p>Test the configuration file by running nginx -t. If everything is ok, we can reload by running nginx -s reload.</p>
</div>
<div class="paragraph">
<p>Now, if you visit your site you will see the following:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-2d49e.png" alt="misc 2d49e">
</div>
</div>
<div class="paragraph">
<p>Whenever you see this, it means that nginx was unable to pass the request to the upstream process. At the moment, its because its trying to pass the request to 127.0.0.1:8000 but there is no process listening at that address.</p>
</div>
<div class="paragraph">
<p>Lets start the Django development server and try again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd /home/django/tutorial
python manage.py runserver 127.0.0.1:8000</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_mounting_django_on_gunicorn">Mounting Django on Gunicorn</h5>
<div class="paragraph">
<p>Remember, <strong>we dont want to use our Django development server in production</strong>. Instead, well use a <strong>Web Server Gateway Interface (WSGI) server</strong> to run Django. Nginx will pass the request to the WSGI server, which is running Django.</p>
</div>
<div class="paragraph">
<p>Common choices for a WSGI server are Gunicorn and uWSGI. For this tutorial we will use Gunicorn.</p>
</div>
<div class="paragraph">
<p>Lets install Gunicorn &amp; start it as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre>pip install gunicorn
cd /home/django/tutorial
gunicorn tutorial.wsgi</pre>
</div>
</div>
<div class="paragraph">
<p>Now you should be able to visit your website and see your application running properly.</p>
</div>
</div>
<div class="sect4">
<h5 id="_running_gunicorn_as_a_service"><strong>Running Gunicorn as a service</strong></h5>
<div class="paragraph">
<p>There are a few issues with running gunicorn like this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If we close the SSH session, the gunicorn process will stop.</p>
</li>
<li>
<p>If the server reboots, the gunicorn process wont start.</p>
</li>
<li>
<p>The process is running as root. If hackers find an exploit in our apps code, theyll be able to run commands as root. We dont want this; but thats why we created the djangouser!</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To solve these problems, were going to run Gunicorn as a systemd service.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd /home/django
mkdir bin
cd /home/django/bin
touch start-server.sh</pre>
</div>
</div>
<div class="paragraph">
<p>In start-server.sh</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd /home/django
source env/bin/activate
cd tutorial
gunicorn tutorial.wsgi</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can test the script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bash /home/django/bin/start-server.sh</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Now we create the systemd service for Gunicorn. Create /etc/systemd/system/gunicorn.serviceas follows:</div>
<div class="content">
<pre>Description=Gunicorn
After=network.target

[Service]
Type=simple
User=django
ExecStart=/home/django/bin/start-server.sh
Restart=on-failure

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="paragraph">
<p>Now, lets enable the service &amp; start it</p>
</div>
<div class="listingblock">
<div class="content">
<pre>systemctl enable gunicorn #for start after reboot
systemctl start gunicorn</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_implementation_of_text_reading_logsite">Implementation of Text reading logsite</h5>
<div class="listingblock">
<div class="title">urls.py</div>
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">from django.contrib import admin
from django.urls import path
from django.conf.urls import url
from logsite import views

urlpatterns = [
    path('admin/', admin.site.urls),
    url(r'^test/$', views.read_file, name='test'),
]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">views.py</div>
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">from django.http import HttpResponse

def read_file(request):
    f = open('/root/logsite/logsite/log.txt', 'r')
    file_content_1 = f.read().split('\n')
    file_content = "\n".join(file_content_1[-50:])
    f.close()
    return HttpResponse(file_content, content_type="text/plain")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Crontab</div>
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">* * * * * journalctl -f -u gst.service --since today &gt; ~/logsite/logsite/log.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wasn&#8217;t able to proxy direct nginx to gunicorn logsite, hence ditched
Even followed this link <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-16-04">Digital oceon</a></p>
</div>
<div class="paragraph">
<p>So modified the gunicorn to</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gunicorn -b 0.0.0.0:8080 logsite.wsgi</pre>
</div>
</div>
<div class="listingblock">
<div class="title">start_server.sh</div>
<div class="content">
<pre>#!/bin/bash
exec &gt; /root/logsite/script_log.txt
cd /root/logsite/
gunicorn -b 0.0.0.0:8080 logsite.wsgi</pre>
</div>
</div>
<div class="listingblock">
<div class="title">logsite.service</div>
<div class="content">
<pre>[Service]
Type=forking
ExecStart = /root/logsite/start_server.sh  #primary code that is run, see ~ is not used
Restart = always
WorkingDirectory = /root/logsite/
#RestartSec = 10s #Restart every 10 seconds

[Install]
WantedBy=multi-user.target  #Important for enabling at restart</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_choosing_appropriate_camera">Choosing appropriate camera</h4>
<div class="sect4">
<h5 id="_machine_vision_vs_surveillance">Machine vision vs. Surveillance</h5>
<div class="paragraph">
<p>For most applications in factory automation or the medical field you will need a machine vision camera. A machine vision camera captures image data and sends it uncompressed to the PC. This is the reason why pictures look less pretty than the ones from cell phones. In consumer cameras the image data gets compressed and smoothed out which looks good, but doesnt provide the quality needed for flaw detection and code reading.</p>
</div>
<div class="paragraph">
<p>Network cameras or IP (Internet Protocol) cameras record video and compress it. Their advantage is their robustness and resistance to vibration and temperature spikes. They are also tolerant to poor lighting conditions and direct sunlight. IP cameras are mainly used in surveillance and in Intelligent Traffic Systems (ITS) applications, for example, for road tolling and red light detection.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Raw Data vs Compressed in h264</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_area_scan_vs_line_scan">Area scan vs. Line scan</h5>
<div class="paragraph">
<p>If you have a high-speed application with a conveyor belt, you will need a line scan camera. These cameras use a single line of pixels (sometimes two or three lines) to capture the image data. They can check the printing quality of newspapers at a speed up to 60 mph, quickly sort letters and packages in logistics, inspect food for damages. They also control the quality of plastic films, steel, textiles, wafers and electronics.</p>
</div>
<div class="paragraph">
<p>If you need in-depth inspection, area scan cameras are your choice. They have a rectangular sensor consisting of several lines of pixels and capture the whole image at the same time. Area scan cameras are used in quality assurance systems, code reading, and for pick and place processes in robotics. They also get integrated in microscopes, dental scanners, and other medical devices.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-6947f.png" alt="Line Camera">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_monochrome_vs_color">Monochrome vs. Color</h5>
<div class="paragraph">
<p>Monochrome cameras are mostly a better choice if the application does not require a color analysis. Because they dont need a color filter, they are more sensitive than color cameras and deliver more detailed images.</p>
</div>
<div class="paragraph">
<p>Most of the color machine vision cameras use the Bayer matrix to capture color data. Each pixel has a color filter, half of them green and a quarter red and blue each. The debayering algorithm uses the information from adjoining pixels to determine the color of each pixel. So a 22 debayering reads the information from three adjoining pixels and 55 debayering reads the information from 24 adjoining pixels. So if you need a color camera, the bigger the debayering number, the better.
image::images/misc-522e3.png[]
==== CMOS vs. CCD</p>
</div>
<div class="paragraph">
<p>In CMOS cameras, the electronics that convert the light into electronic signals are integrated into the surface of the sensor. This makes the transfer of the data especially quick. CMOS sensors are less expensive, dont have blooming or smear and have a higher dynamic range. That allows them for example to capture both a high-lit license plate and the shadowed person in the car in one and the same image.</p>
</div>
<div class="paragraph">
<p>Because the CCD sensors do not have conversion electronics on the sensors surface, they can capture more light and so have a lower noise factor, high fill factor, and higher color fidelity. These properties make CCD cameras a good choice for low-light and low-speed applications like astronomy.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-fec4e.png" alt="misc fec4e">
</div>
</div>
<div class="literalblock">
<div class="title">CCD</div>
<div class="content">
<pre>Low noise, but slow</pre>
</div>
</div>
<div class="literalblock">
<div class="title">CMOS</div>
<div class="content">
<pre>Digital at site, fast/cheap</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_global_vs_rolling_shutter">Global vs. Rolling Shutter</h5>
<div class="paragraph">
<p>If you want to avoid distortions at high speeds and are not too concerned about price, then global shutter is the optimal choice. With the global shutter the entire sensor surface gets exposed to light at once. Its great for high-speed applications, such as traffic and transportation, or logistics.</p>
</div>
<div class="paragraph">
<p>The rolling shutter reads the image line-by-line. The captured lines are then recomposed into one image. If the object is moving fast or the lighting conditions are bad, the image gets distorted. However, adjusting the exposure time and implementing flash, you can minimize the distortion. Rolling shutter is less expensive and is available only on CMOS based cameras.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/misc-b137e.png" alt="Black is the capturing part">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_frame_rate">Frame Rate</h5>
<div class="paragraph">
<p>Frame rate is the number of images that the sensor can capture and transmit per second. The human brain detects approximately 14 to 16 images per second; the frame rate of a movie is usually 24 fps. For fast-moving applications like inspections of newspapers the camera needs to shoot in milliseconds. On the other end there are microscopic applications which require low frame rates comparable to the ones of the human eye.
image::images/misc-e3a80.png[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_resolution">Resolution</h5>
<div class="paragraph">
<p>A simple formula is used to determine which resolution is required for your application: Resolution = (Object Size / Detail size).</p>
</div>
<div class="paragraph">
<p>Lets say you want to determine the eye color of a person who is two meters tall.</p>
</div>
<div class="paragraph">
<p>(2 m  1 mm) = 4,000,000 pixels = 4 MP</p>
</div>
<div class="paragraph">
<p>An example of such a resolution would be 2048 px x 2048 px.</p>
</div>
<div class="paragraph">
<p>Resolution is a key consideration in the process of choosing a machine vision camera. Calculating the resolution requires knowing the size of the field of view and knowing the smallest feature that needs to be resolved. The term features usually refers to defects in a product or a very small element on the object. The feature might be something that is supposed to be there, such as a tiny hole in a printed circuit board, or it could be something that is not supposed to be there, such as a scratch on an aluminum sheet. In these cases, there is a need to detect what that feature is, whether it is a defect or something that is meant to be there.</p>
</div>
<div class="paragraph">
<p>For many, when considering how small a feature is necessary to detect, the knee-jerk reaction is to get a camera that detects everything. This approach is not always realistic or necessary. Resolution is one of the main elements driving camera costs. It is important to get as much resolution as needed, but not to overdo it. Typically, the rule of thumb is this: To be able to accurately detect a feature of a certain size, plan on at least three pixels covering that area. It is not always possible to detect a feature by interpreting a single pixel. Several pixels across the feature can ensure it is not an aberration. For example, to detect a feature as small as 1/100 of an inch, choose a pixel size three times smaller than that, or 3/1000 of an inch.</p>
</div>
<div class="paragraph">
<p>The higher the resolution, the easier it will be to identify features, but now is the time to weigh the cost of the system against how much resolution is needed. Before committing, do some testing. Borrow a camera from a manufacturer, or use a high resolution photography camera to get an idea of how much resolution is required to see what needs to be seen.</p>
</div>
</div>
<div class="sect4">
<h5 id="_interface">Interface</h5>
<div class="paragraph">
<p>If your camera is far from the PC or if you need multiple cameras in one system, youll need GigE. It allows cable lengths up to 100 m and makes multi-camera integration easy. However, USB 3.0 gives you more than three times the bandwidth (350 MB/s versus 100 MB/s), is plug-and-play and has power and data via one cable. It can work with cable lengths only up to 8 m. If you need the highest possible bandwidthup to 850 MB/sthen Camera Link is the best choice. Camera Link requires a frame grabber and so the system costs are higher.</p>
</div>
</div>
<div class="sect4">
<h5 id="_size">Size</h5>
<div class="paragraph">
<p>Today the most popular compact camera size is around 30 mm each side. The miniaturization continues and so there is a new class of bare board cameras without housing and only 6 mm thin. These cameras are good for size-restricted and cost-effective applications in the embedded field. These require a different infrastructure: computer on chip instead of PCs, ARM processor architecture instead of x86; Linux, Windows IoT or Android instead of Windows. Some setups can use the USB 3.0 interface, but MIPI and LVDS-based interfaces allow more flexibility and compactness</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_yolo_deepstream_sdk_on_jetson_nano">Yolo DeepStream SDK on Jetson Nano</h4>
<div class="paragraph">
<p>I didn&#8217;t followed a tutorial. After several studies I got to that point. You need, first, search how to train a yolo custom model. You will need several images to train. Jetson Nano can only run Yolo Tiny.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.nvidia.com/metropolis/" class="bare">https://docs.nvidia.com/metropolis/</a></p>
</div>
<div class="videoblock">
<div class="content">
<iframe src="https://www.youtube.com/embed/n3uYS550PDo?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/marcoslucianops/DeepStream-Yolo" class="bare">https://github.com/marcoslucianops/DeepStream-Yolo</a></p>
</div>
<div class="paragraph">
<p>Pre-treined Yolo model (for NVIDIA Jetson Nano, I recommend YoloV3-Tiny or YoloV3-Tiny-PRN &#8592; Fastest)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_raspberry_pi_based_image_capture">Raspberry pi based image capture</h3>
<div class="sect3">
<h4 id="_version_1">Version 1</h4>
<div class="imageblock">
<div class="content">
<img src="images/misc-fe2a9.png" alt="misc fe2a9">
</div>
</div>
<div class="paragraph">
<p>So just cron and txt file based delay function</p>
</div>
<div class="paragraph">
<p><a href="https://stackoverflow.com/questions/34904548/how-to-grab-a-single-image-from-rtsp-stream-using-ffmpeg" class="bare">https://stackoverflow.com/questions/34904548/how-to-grab-a-single-image-from-rtsp-stream-using-ffmpeg</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>ffmpeg -y -i rtsp://admin:aj123456@192.168.1.64 -vframes 1 cap.jpg</pre>
</div>
</div>
<div class="paragraph">
<p>Now to build the delay inside python and execute the command</p>
</div>
<div class="paragraph">
<p><strong>cap.py</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import os
import time

f= open("/boot/cap.txt", "r")
config = f.read().split("\n")
delay = int(config[0])
print(delay)
times = int(3600/delay)
cmd = 'ffmpeg -y -i rtsp://admin:aj123456@192.168.1.64 -vframes 1 cap.jpg'
for i in range(times):
  time.sleep(delay)
  ret= os.system(cmd)
  print(i)</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_uploading_to_s3">Uploading to s3</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import logging
import boto3
from botocore.exceptions import ClientError


def upload_file(file_name, bucket, object_name=None):
    """Upload a file to an S3 bucket

    :param file_name: File to upload
    :param bucket: Bucket to upload to
    :param object_name: S3 object name. If not specified then file_name is used
    :return: True if file was uploaded, else False
    """

    # If S3 object_name was not specified, use file_name
    if object_name is None:
        object_name = cap.jpg

    ACCESS_KEY = 'AKIAZSYQDTTNJ5O4Y2G6'
    SECRET_KEY = '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'

    # Upload the file
    s3_client = boto3.client('s3',aws_access_key_id=ACCESS_KEY,aws_secret_access_key=SECRET_KEY)
    try:
        response = s3_client.upload_file(file_name, bucket, object_name)
    except ClientError as e:
        logging.error(e)
        return False
    return True</code></pre>
</div>
</div>
<div class="paragraph">
<p>Final version</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py">import os
import time

import logging
import boto3
from botocore.exceptions import ClientError


def upload_file(file_name, bucket, object_name=None):
    """Upload a file to an S3 bucket

    :param file_name: File to upload
    :param bucket: Bucket to upload to
    :param object_name: S3 object name. If not specified then file_name is used
    :return: True if file was uploaded, else False
    """

    # If S3 object_name was not specified, use file_name
    if object_name is None:
        object_name = file_name

    # Upload the file
    ACCESS_KEY = 'AKIAZSYQDTTNJ5O4Y2G6'
    SECRET_KEY = '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'

    # Upload the file
    s3_client = boto3.client('s3',aws_access_key_id=ACCESS_KEY,aws_secret_access_key=SECRET_KEY)
    try:
        response = s3_client.upload_file(file_name, bucket, object_name)
    except ClientError as e:
        logging.error(e)
        return False
    return True


f= open("/boot/cap.txt", "r")
config = f.read().split("\n")
delay = int(config[0])
print(delay)
times = int(3600/delay)
cmd = 'ffmpeg -y -i rtsp://admin:aj123456@192.168.1.64 -vframes 1 cap.jpg'
for i in range(times):
  time.sleep(delay)
  ret= os.system(cmd)
  upload_file('cap.jpg', 'cctv-capture', time.strftime("%Y%m%d-%H%M%S")+".jpg")
  print(i)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_version_3">Version 3</h4>
<div class="imageblock">
<div class="content">
<img src="images/misc-2a2c8.png" alt="misc 2a2c8">
</div>
</div>
<div class="sect5">
<h6 id="_running_a_simple_django_server_in_rpi">Running a simple django server in RPI</h6>
<div class="literalblock">
<div class="content">
<pre>pip3 install django
django-admin startproject cctvcapture</pre>
</div>
</div>
<div class="paragraph">
<p>Start a new app</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python3 manage.py startapp capUpload</pre>
</div>
</div>
<div class="paragraph">
<p>Attach the app to the project</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ALLOWED_HOSTS = ["0.0.0.0","192.168.1.253"]</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre># Application definition</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>INSTALLED_APPS = [
  'django.contrib.admin',
  'django.contrib.auth',
  'django.contrib.contenttypes',
  'django.contrib.sessions',
  'django.contrib.messages',
  'django.contrib.staticfiles',
  'capUpload',
]</pre>
</div>
</div>
<div class="paragraph">
<p>Create a view</p>
</div>
<div class="literalblock">
<div class="content">
<pre>from django.shortcuts import render</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>def hello_world(request):
  return render(request, 'cap.html', {})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>python3 manage.py runserver 0.0.0.0:8000</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gitlab_host_on_server">Gitlab host on Server</h3>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get update
sudo apt-get install -y curl openssh-server ca-certificates
sudo apt-get install -y postfix</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.deb.sh | sudo bash</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  sudo EXTERNAL_URL="https://gitlab.gokul.com" apt-get install gitlab-ee
// :leveloffset: 1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_combining_to_book">Combining to Book</h3>
<div class="listingblock">
<div class="content">
<pre>= My Book

// include::chapter01.adoc[leveloffset=+1]

// include::chapter02.adoc[leveloffset=+1]

// include::chapter03.adoc[leveloffset=+1]</pre>
</div>
</div>
<div class="paragraph">
<p>Including non-AsciiDoc files is normally done to merge output from other programs or populate table data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.2016 Sales Results
,===
// include::sales/2016/results.csv[]
,===</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2020-05-07 19:29:08 +0800
</div>
</div>
</body>
</html>